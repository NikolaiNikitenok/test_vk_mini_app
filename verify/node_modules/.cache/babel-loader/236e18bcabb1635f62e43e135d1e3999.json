{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\k8909\\\\OneDrive\\\\\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B\\\\GitHub\\\\test_vk_mini_app\\\\verify\\\\src\\\\panels\\\\Home.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { useState, useEffect } from 'react';\nimport PropTypes, { string } from 'prop-types';\nimport { Panel, PanelHeader, PanelHeaderBack, Header, Button, Group, Cell, Div, Avatar, Tabs, TabsItem, List, Footer, PopoutWrapper, Textarea, Checkbox, Link, Radio, FormLayout, FormItem, Input } from '@vkontakte/vkui';\nimport { Icon28SettingsOutline, Icon28LogoVk } from '@vkontakte/icons';\nimport Web3 from 'web3';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Home = () => {\n  _s();\n\n  const contAdress = '';\n  const userAdress = '';\n  const [contractik, setContractik] = useState('');\n  const [adressok, setAdressok] = useState('');\n  const [ethBalance, setEthBalance] = useState('');\n  const [ethAcc, setEthAcc] = useState('');\n  const [isConnected, setIsConnected] = useState(false);\n  const [ethAdd, setEthAdd] = useState(false);\n  const [walletIsConnected, setWalletIsConnected] = useState(false);\n\n  const detectCurrentProvider = () => {\n    let provider;\n\n    if (window.ethereum) {\n      provider = window.ethereum;\n    } else if (window.web3) {\n      provider = window.web3.currentProvider;\n    } else {\n      console.log(\"Non-ethereum browser detected. You should install Metamask\");\n    }\n\n    return provider;\n  };\n\n  const onConnect = async () => {\n    try {\n      const currentProvider = detectCurrentProvider();\n      const ABI = [{\n        \"inputs\": [{\n          \"internalType\": \"address\",\n          \"name\": \"_tiketStor\",\n          \"type\": \"address\"\n        }],\n        \"stateMutability\": \"nonpayable\",\n        \"type\": \"constructor\"\n      }, {\n        \"inputs\": [],\n        \"name\": \"tiketStor\",\n        \"outputs\": [{\n          \"internalType\": \"address\",\n          \"name\": \"\",\n          \"type\": \"address\"\n        }],\n        \"stateMutability\": \"view\",\n        \"type\": \"function\"\n      }, {\n        \"inputs\": [{\n          \"internalType\": \"address\",\n          \"name\": \"_collection\",\n          \"type\": \"address\"\n        }, {\n          \"internalType\": \"address\",\n          \"name\": \"_user\",\n          \"type\": \"address\"\n        }],\n        \"name\": \"verifier\",\n        \"outputs\": [{\n          \"internalType\": \"bool\",\n          \"name\": \"\",\n          \"type\": \"bool\"\n        }],\n        \"stateMutability\": \"view\",\n        \"type\": \"function\"\n      }];\n\n      if (currentProvider) {\n        await currentProvider.request({\n          method: 'eth_requestAccounts'\n        });\n        const web3 = new Web3(currentProvider);\n        const userAccount = await web3.eth.getAccounts();\n        const account = userAccount[0];\n        let ethBalance = await web3.eth.getBalance(account);\n        console.log(account);\n        console.log(window.location.hash); // setDoneScreenSpinner();\n\n        setEthBalance(ethBalance);\n        setEthAcc(account);\n        setIsConnected(true);\n        const Address = \"0x59a195a6524b231Ce41F3Cbc8263d57F426E90E0\";\n        setEthAdd(Address);\n        window.web3 = await new Web3(window.ethereum);\n        window.contract = await new window.web3.eth.Contract(ABI, Address);\n        setWalletIsConnected(true);\n        let hashik = window.location.hash.substring(1);\n        let hashikMass = [];\n        hashikMass = hashik.split('/');\n        contAdress = hashikMass[1];\n        setContractik(contAdress);\n        userAdress = hashikMass[0];\n        setAdressok(userAdress);\n        console.log(adressok);\n        console.log(contractik); // counter\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  }; // const useHash = () => {\n  // \tconst [hash, setHash] = React.useState(() => window.location.hash);\n  // \tconst hashChangeHandler = React.useCallback(() => {\n  // \t\tsetHash(window.location.hash);\n  // \t}, []);\n  // \tReact.useEffect(() => {\n  // \t\twindow.addEventListener('hashchange', hashChangeHandler);\n  // \t\treturn () => {\n  // \t\t\twindow.removeEventListener('hashchange', hashChangeHandler);\n  // \t\t};\n  // \t}, []);\n  // \tconst updateHash = React.useCallback(\n  // \t\tnewHash => {\n  // \t\t\tif (newHash !== hash) window.location.hash = newHash;\n  // \t\t},\n  // \t\t[hash]\n  // \t);\n  // \treturn [hash, updateHash];\n  // };\n\n\n  const checkVal = async () => {\n    const perem = await window.contract.methods.verifier(contractik, adressok).call({\n      from: ethAcc\n    });\n    console.log(perem);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Panel, {\n    children: [/*#__PURE__*/_jsxDEV(PanelHeader, {\n      left: /*#__PURE__*/_jsxDEV(Icon28LogoVk, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 23\n      }, this),\n      children: \" Verify\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Group, {\n      className: \"app-wrapper\",\n      header: /*#__PURE__*/_jsxDEV(Header, {\n        mode: \"secondary\",\n        children: \"\\u041F\\u043E\\u0434\\u043A\\u043B\\u044E\\u0447\\u0435\\u043D\\u0438\\u0435 MetaMask\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 43\n      }, this),\n      children: [!isConnected && /*#__PURE__*/_jsxDEV(Div, {\n        children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"app-button__login\",\n          stretched: true,\n          size: \"l\",\n          mode: \"secondary\",\n          onClick: onConnect,\n          children: \"\\u041F\\u043E\\u0434\\u043A\\u043B\\u044E\\u0447\\u0438\\u0442\\u044C MetaMask\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 6\n      }, this), isConnected && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(Div, {\n          className: \"app-wrapper\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"app-details\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \" \\u0412\\u044B \\u043F\\u043E\\u0434\\u043A\\u043B\\u044E\\u0447\\u0438\\u043B\\u0438\\u0441\\u044C \\u043A MetaMask.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(Group, {\n              header: /*#__PURE__*/_jsxDEV(Header, {\n                mode: \"secondary\",\n                children: \"\\u0418\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 23\n              }, this),\n              children: /*#__PURE__*/_jsxDEV(Div, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"app-balance\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u0411\\u0430\\u043B\\u0430\\u043D\\u0441 \\u041A\\u043E\\u0448\\u0435\\u043B\\u044C\\u043A\\u0430: \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 164,\n                    columnNumber: 11\n                  }, this), ethBalance / 10 ** 18]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 10\n                }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 167,\n                  columnNumber: 10\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u0410\\u0434\\u0440\\u0435\\u0441 \\u041A\\u043E\\u0448\\u0435\\u043B\\u044C\\u043A\\u0430: \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 169,\n                    columnNumber: 11\n                  }, this), ethAcc]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 10\n                }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 172,\n                  columnNumber: 10\n                }, this), walletIsConnected && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u0410\\u0434\\u0440\\u0435\\u0441 \\u041A\\u043E\\u043D\\u0442\\u0440\\u0430\\u043A\\u0442\\u0430: \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 175,\n                    columnNumber: 12\n                  }, this), ethAdd]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 11\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(FormLayout, {\n              children: [/*#__PURE__*/_jsxDEV(FormItem, {\n                top: \"\\u041A\\u043E\\u043D\\u0442\\u0440\\u0430\\u043A\\u0442\",\n                status: contractik ? 'valid' : 'error',\n                bottom: contractik ? '' : 'Обязательное поле!',\n                children: /*#__PURE__*/_jsxDEV(Input, {\n                  type: \"name\",\n                  name: \"name\",\n                  onChange: event => setContractik(event.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 191,\n                  columnNumber: 9\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(FormItem, {\n                top: \"\\u0410\\u0434\\u0440\\u0435\\u0441\",\n                status: adressok ? 'valid' : 'error',\n                bottom: adressok ? '' : 'Обязательное поле!',\n                children: /*#__PURE__*/_jsxDEV(Input, {\n                  type: \"name\",\n                  name: \"name\",\n                  onChange: event => setAdressok(event.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 200,\n                  columnNumber: 9\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                size: \"l\",\n                onClick: checkVal,\n                children: \"\\u041F\\u0440\\u043E\\u0432\\u0435\\u0440\\u0438\\u0442\\u044C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 9\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 6\n        }, this)\n      }, void 0, false)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 142,\n    columnNumber: 3\n  }, this);\n};\n\n_s(Home, \"b6/+HV7ssc9b2BfXTX8lMXJM2cg=\");\n\n_c = Home;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["C:/Users/k8909/OneDrive/Документы/GitHub/test_vk_mini_app/verify/src/panels/Home.js"],"names":["React","useState","useEffect","PropTypes","string","Panel","PanelHeader","PanelHeaderBack","Header","Button","Group","Cell","Div","Avatar","Tabs","TabsItem","List","Footer","PopoutWrapper","Textarea","Checkbox","Link","Radio","FormLayout","FormItem","Input","Icon28SettingsOutline","Icon28LogoVk","Web3","Home","contAdress","userAdress","contractik","setContractik","adressok","setAdressok","ethBalance","setEthBalance","ethAcc","setEthAcc","isConnected","setIsConnected","ethAdd","setEthAdd","walletIsConnected","setWalletIsConnected","detectCurrentProvider","provider","window","ethereum","web3","currentProvider","console","log","onConnect","ABI","request","method","userAccount","eth","getAccounts","account","getBalance","location","hash","Address","contract","Contract","hashik","substring","hashikMass","split","err","checkVal","perem","methods","verifier","call","from","event","target","value"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { useState, useEffect} from 'react';\r\nimport PropTypes, { string } from 'prop-types';\r\n\r\nimport { \r\n\tPanel, \r\n\tPanelHeader, \r\n\tPanelHeaderBack, \r\n\tHeader, \r\n\tButton, \r\n\tGroup, \r\n\tCell, \r\n\tDiv, \r\n\tAvatar, \r\n\tTabs, \r\n\tTabsItem, \r\n\tList, \r\n\tFooter, \r\n\tPopoutWrapper,\r\n\tTextarea,\r\n\tCheckbox,\r\n\tLink,\r\n\tRadio,\r\n\tFormLayout, \r\n\tFormItem, \r\n\tInput, \r\n} from '@vkontakte/vkui';\r\nimport {Icon28SettingsOutline, Icon28LogoVk} from '@vkontakte/icons';\r\nimport Web3 from 'web3';\r\n\r\nconst Home = () => {\r\n\r\n\r\n\tconst contAdress = ''\r\n\tconst userAdress = ''\r\n\r\n\tconst[contractik, setContractik] = useState('')\r\n\tconst[adressok, setAdressok] = useState('')\r\n\tconst[ethBalance, setEthBalance] = useState('')\r\n\tconst[ethAcc, setEthAcc] = useState('')\r\n\tconst[isConnected, setIsConnected] = useState(false)\r\n\tconst[ethAdd, setEthAdd] = useState(false)\r\n\tconst[walletIsConnected, setWalletIsConnected] = useState(false)\r\n\r\n\tconst detectCurrentProvider = () => {\r\n    let provider;\r\n    if (window.ethereum) {\r\n      provider = window.ethereum;\r\n    } else if (window.web3) {\r\n      provider = window.web3.currentProvider;\r\n    } else {\r\n      console.log(\"Non-ethereum browser detected. You should install Metamask\");\r\n    }\r\n    return provider;\r\n  };\r\n\r\n\tconst onConnect = async () => {\r\n\t\ttry {\r\n\t\t\tconst currentProvider = detectCurrentProvider();\r\n\t\t\tconst ABI = [{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_tiketStor\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"tiketStor\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_collection\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_user\",\"type\":\"address\"}],\"name\":\"verifier\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"}]\r\n\r\n\t\t\tif(currentProvider) {\r\n        \r\n        await currentProvider.request({method: 'eth_requestAccounts'});\r\n        const web3 = new Web3(currentProvider);\r\n        const userAccount = await web3.eth.getAccounts();\r\n        const account = userAccount[0];\r\n        let ethBalance = await web3.eth.getBalance(account);\r\n        console.log(account);\r\n\r\n\t\t\t\tconsole.log(window.location.hash)\r\n\r\n        // setDoneScreenSpinner();\r\n        setEthBalance(ethBalance);\r\n        setEthAcc(account)\r\n        setIsConnected(true);\r\n      \r\n\t\t\t\tconst Address = \"0x59a195a6524b231Ce41F3Cbc8263d57F426E90E0\";\r\n\t\t\t\tsetEthAdd(Address)\r\n\t\t\t\twindow.web3 = await new Web3(window.ethereum);\r\n\t\t\t\twindow.contract = await new window.web3.eth.Contract(ABI, Address);\r\n\t\t\t\tsetWalletIsConnected(true);\r\n\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tlet hashik = (window.location.hash).substring(1);\r\n\t\t\t\tlet hashikMass = []\r\n\t\t\t\thashikMass = hashik.split('/')\r\n\t\t\t\tcontAdress = hashikMass[1]\r\n\t\t\t\tsetContractik(contAdress)\r\n\t\t\t\tuserAdress = hashikMass[0]\r\n\t\t\t\tsetAdressok(userAdress)\r\n\r\n\t\t\t\tconsole.log(adressok)\r\n\t\t\t\tconsole.log(contractik)\r\n\t\t\r\n\r\n\r\n\t\t\t\t// counter\r\n\t\t\t\r\n      }\r\n    } catch(err) {\r\n      console.log(err);\r\n    }\r\n\r\n\r\n\t\t\r\n  }\r\n\r\n\r\n\t// const useHash = () => {\r\n\t// \tconst [hash, setHash] = React.useState(() => window.location.hash);\r\n\t\r\n\t// \tconst hashChangeHandler = React.useCallback(() => {\r\n\t// \t\tsetHash(window.location.hash);\r\n\t// \t}, []);\r\n\t\r\n\t// \tReact.useEffect(() => {\r\n\t// \t\twindow.addEventListener('hashchange', hashChangeHandler);\r\n\t// \t\treturn () => {\r\n\t// \t\t\twindow.removeEventListener('hashchange', hashChangeHandler);\r\n\t// \t\t};\r\n\t// \t}, []);\r\n\t\r\n\t// \tconst updateHash = React.useCallback(\r\n\t// \t\tnewHash => {\r\n\t// \t\t\tif (newHash !== hash) window.location.hash = newHash;\r\n\t// \t\t},\r\n\t// \t\t[hash]\r\n\t// \t);\r\n\t\r\n\t// \treturn [hash, updateHash];\r\n\t// };\r\n\r\n\tconst checkVal = async () => {\r\n\t\tconst perem = await window.contract.methods.verifier(contractik, adressok).call({ from: ethAcc });\r\n\t\tconsole.log(perem)\r\n\t\t\r\n\t}\r\n\r\n\treturn(\r\n\t\t<Panel>\r\n\t\t\t<PanelHeader left={<Icon28LogoVk/>}> Verify\r\n\t\t\t\t\t\t\r\n\t\t\t</PanelHeader>\r\n\t\t\t<Group className=\"app-wrapper\" header={<Header mode=\"secondary\">Подключение MetaMask</Header>}>\r\n\t\t\t\t{!isConnected && (\r\n\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t\t<Button className=\"app-button__login\" stretched size=\"l\" mode=\"secondary\" onClick={onConnect}>\r\n\t\t\t\t\t\tПодключить MetaMask\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Div>\r\n\t\t\t\t)}\r\n\t\t\t\r\n\t\t\t\t{isConnected && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t<Div className=\"app-wrapper\">\r\n\t\t\t\t\t\t<div className=\"app-details\">\r\n\t\t\t\t\t\t\t<h2> Вы подключились к MetaMask.</h2>\r\n\t\t\t\t\t\t\t<Group header={<Header mode=\"secondary\">Информация</Header>}>\r\n\t\t\t\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"app-balance\">\r\n\t\t\t\t\t\t\t\t\t\t<span>Баланс Кошелька: </span>\r\n\t\t\t\t\t\t\t\t\t\t{ethBalance / (10**18)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<span>Адрес Кошелька: </span>\r\n\t\t\t\t\t\t\t\t\t\t{ethAcc}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t\t\t\t\t{walletIsConnected && (\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<span>Адрес Контракта: </span>\r\n\t\t\t\t\t\t\t\t\t\t\t{ethAdd}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t\t</Group>\r\n\t\t\t\t\t\t\t<FormLayout>\r\n\r\n\t\t\t\t\t\t\t\t{/* Название */}\r\n\t\t\t\t\t\t\t\t<FormItem\r\n\t\t\t\t\t\t\t\ttop=\"Контракт\"\r\n\t\t\t\t\t\t\t\tstatus={contractik ? 'valid' : 'error'}\r\n\t\t\t\t\t\t\t\tbottom={\r\n\t\t\t\t\t\t\t\t\tcontractik ? '' : 'Обязательное поле!'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Input type=\"name\" name=\"name\" onChange={(event) => setContractik(event.target.value)}/>\r\n\t\t\t\t\t\t\t\t</FormItem>\r\n\t\t\t\t\t\t\t\t<FormItem\r\n\t\t\t\t\t\t\t\ttop=\"Адрес\"\r\n\t\t\t\t\t\t\t\tstatus={adressok ? 'valid' : 'error'}\r\n\t\t\t\t\t\t\t\tbottom={\r\n\t\t\t\t\t\t\t\t\tadressok ? '' : 'Обязательное поле!'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Input type=\"name\" name=\"name\" onChange={(event) => setAdressok(event.target.value)}/>\r\n\t\t\t\t\t\t\t\t</FormItem>\r\n\r\n\t\t\t\t\t\t\t\t<Button size=\"l\" onClick={checkVal}>Проверить</Button>\r\n\r\n\t\t\t\t\t\t\t</FormLayout>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t</Div>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</Group>\r\n\t\t</Panel>\r\n\t)\r\n}\r\n\r\nexport default Home;\r\n"]},"metadata":{},"sourceType":"module"}