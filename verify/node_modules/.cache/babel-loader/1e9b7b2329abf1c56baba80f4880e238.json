{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _createSuper from \"@babel/runtime/helpers/createSuper\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nvar _excluded = [\"actions\", \"actionsLayout\", \"children\", \"className\", \"style\", \"platform\", \"viewWidth\", \"text\", \"header\"];\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from \"react\";\nimport Tappable from \"../Tappable/Tappable\";\nimport { PopoutWrapper } from \"../PopoutWrapper/PopoutWrapper\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { classNames } from \"../../lib/classNames\";\nimport { transitionEvent } from \"../../lib/supportEvents\";\nimport { ANDROID, VKCOM, IOS } from \"../../lib/platform\";\nimport { withPlatform } from \"../../hoc/withPlatform\";\nimport { withAdaptivity, ViewWidth } from \"../../hoc/withAdaptivity\";\nimport Button from \"../Button/Button\";\nimport { hasReactNode } from \"../../lib/utils\";\nimport Headline from \"../Typography/Headline/Headline\";\nimport Title from \"../Typography/Title/Title\";\nimport { Caption } from \"../Typography/Caption/Caption\";\nimport ModalDismissButton from \"../ModalDismissButton/ModalDismissButton\";\nimport { FocusTrap } from \"../FocusTrap/FocusTrap\";\n\nvar AlertComponent = /*#__PURE__*/function (_React$Component) {\n  _inherits(AlertComponent, _React$Component);\n\n  var _super = _createSuper(AlertComponent);\n\n  function AlertComponent(props) {\n    var _this;\n\n    _classCallCheck(this, AlertComponent);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"element\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"transitionFinishTimeout\", undefined);\n\n    _defineProperty(_assertThisInitialized(_this), \"onItemClick\", function (item) {\n      return function () {\n        var action = item.action,\n            autoclose = item.autoclose;\n\n        if (autoclose) {\n          _this.setState({\n            closing: true\n          });\n\n          _this.waitTransitionFinish(function (e) {\n            if (!e || e.propertyName === \"opacity\") {\n              var _this$props$onClose, _this$props;\n\n              autoclose && ((_this$props$onClose = (_this$props = _this.props).onClose) === null || _this$props$onClose === void 0 ? void 0 : _this$props$onClose.call(_this$props));\n              action && action();\n            }\n          });\n        } else {\n          action && action();\n        }\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClose\", function () {\n      _this.setState({\n        closing: true\n      });\n\n      _this.waitTransitionFinish(function (e) {\n        if (!e || e.propertyName === \"opacity\") {\n          var _this$props$onClose2, _this$props2;\n\n          (_this$props$onClose2 = (_this$props2 = _this.props).onClose) === null || _this$props$onClose2 === void 0 ? void 0 : _this$props$onClose2.call(_this$props2);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"stopPropagation\", function (e) {\n      e.stopPropagation();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderAction\", function (action, i) {\n      var platform = _this.props.platform;\n\n      if (platform === IOS) {\n        var _action$Component = action.Component,\n            Component = _action$Component === void 0 ? \"button\" : _action$Component;\n        return createScopedElement(Tappable, {\n          Component: action.href ? \"a\" : Component,\n          vkuiClass: classNames(\"Alert__action\", \"Alert__action--\".concat(action.mode)),\n          onClick: _this.onItemClick(action),\n          href: action.href,\n          key: \"alert-action-\".concat(i),\n          target: action.target\n        }, action.title);\n      }\n\n      var mode = action.mode === \"cancel\" ? \"secondary\" : \"primary\";\n\n      if (platform === ANDROID) {\n        mode = \"tertiary\";\n\n        if (_this.props.viewWidth === ViewWidth.DESKTOP && action.mode === \"destructive\") {\n          mode = \"destructive\";\n        }\n      }\n\n      return createScopedElement(Button, {\n        vkuiClass: classNames(\"Alert__button\", \"Alert__button--\".concat(action.mode)),\n        mode: mode,\n        size: \"m\",\n        onClick: _this.onItemClick(action),\n        Component: action.Component,\n        href: action.href,\n        key: \"alert-action-\".concat(i),\n        target: action.target\n      }, action.title);\n    });\n\n    _this.element = /*#__PURE__*/React.createRef();\n    _this.state = {\n      closing: false\n    };\n    return _this;\n  }\n\n  _createClass(AlertComponent, [{\n    key: \"timeout\",\n    get: function get() {\n      return this.props.platform === ANDROID || this.props.platform === VKCOM ? 200 : 300;\n    }\n  }, {\n    key: \"waitTransitionFinish\",\n    value: function waitTransitionFinish(eventHandler) {\n      if (transitionEvent.supported && this.element.current) {\n        this.element.current.removeEventListener(transitionEvent.name, eventHandler);\n        this.element.current.addEventListener(transitionEvent.name, eventHandler);\n      } else {\n        if (this.transitionFinishTimeout) {\n          clearTimeout(this.transitionFinishTimeout);\n        }\n\n        this.transitionFinishTimeout = setTimeout(eventHandler.bind(this), this.timeout);\n      }\n    }\n  }, {\n    key: \"renderHeader\",\n    value: function renderHeader(header) {\n      switch (this.props.platform) {\n        case VKCOM:\n          return createScopedElement(Headline, {\n            vkuiClass: \"Alert__header\",\n            weight: \"medium\"\n          }, header);\n\n        case IOS:\n          return createScopedElement(Title, {\n            vkuiClass: \"Alert__header\",\n            weight: \"1\",\n            level: \"3\"\n          }, header);\n\n        case ANDROID:\n          return createScopedElement(Title, {\n            vkuiClass: \"Alert__header\",\n            weight: \"2\",\n            level: \"2\"\n          }, header);\n\n        default:\n          return undefined;\n      }\n    }\n  }, {\n    key: \"renderText\",\n    value: function renderText(text) {\n      switch (this.props.platform) {\n        case VKCOM:\n          return createScopedElement(Caption, {\n            vkuiClass: \"Alert__text\"\n          }, text);\n\n        case IOS:\n          return createScopedElement(Caption, {\n            vkuiClass: \"Alert__text\",\n            level: \"2\"\n          }, text);\n\n        case ANDROID:\n          return createScopedElement(Headline, {\n            vkuiClass: \"Alert__text\",\n            weight: \"regular\"\n          }, text);\n\n        default:\n          return undefined;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          actions = _this$props3.actions,\n          actionsLayout = _this$props3.actionsLayout,\n          children = _this$props3.children,\n          className = _this$props3.className,\n          style = _this$props3.style,\n          platform = _this$props3.platform,\n          viewWidth = _this$props3.viewWidth,\n          text = _this$props3.text,\n          header = _this$props3.header,\n          restProps = _objectWithoutProperties(_this$props3, _excluded);\n\n      var closing = this.state.closing;\n      var resolvedActionsLayout = platform === VKCOM ? \"horizontal\" : actionsLayout;\n      var canShowCloseButton = platform === VKCOM || platform === ANDROID && viewWidth >= ViewWidth.SMALL_TABLET;\n      var isDesktop = viewWidth >= ViewWidth.SMALL_TABLET;\n      return createScopedElement(PopoutWrapper, {\n        className: className,\n        closing: closing,\n        style: style,\n        onClick: this.onClose\n      }, createScopedElement(FocusTrap, _extends({}, restProps, {\n        getRootRef: this.element,\n        onClick: this.stopPropagation,\n        onClose: this.onClose,\n        timeout: this.timeout,\n        vkuiClass: classNames(getClassName(\"Alert\", platform), {\n          \"Alert--v\": resolvedActionsLayout === \"vertical\",\n          \"Alert--h\": resolvedActionsLayout === \"horizontal\",\n          \"Alert--closing\": closing,\n          \"Alert--desktop\": isDesktop\n        })\n      }), canShowCloseButton && createScopedElement(ModalDismissButton, {\n        onClick: this.onClose\n      }), createScopedElement(\"div\", {\n        vkuiClass: \"Alert__content\"\n      }, hasReactNode(header) && this.renderHeader(header), hasReactNode(text) && this.renderText(text), children), createScopedElement(\"footer\", {\n        vkuiClass: \"Alert__actions\"\n      }, actions === null || actions === void 0 ? void 0 : actions.map(this.renderAction))));\n    }\n  }]);\n\n  return AlertComponent;\n}(React.Component);\n\n_defineProperty(AlertComponent, \"defaultProps\", {\n  actionsLayout: \"horizontal\",\n  actions: []\n});\n\nexport var Alert = withPlatform(withAdaptivity(AlertComponent, {\n  viewWidth: true\n}));","map":{"version":3,"mappings":"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","names":["React","Tappable","PopoutWrapper","getClassName","classNames","transitionEvent","ANDROID","VKCOM","IOS","withPlatform","withAdaptivity","ViewWidth","Button","hasReactNode","Headline","Title","Caption","ModalDismissButton","FocusTrap","AlertComponent","props","_classCallCheck","_this","_defineProperty","undefined","item","action","autoclose","setState","closing","waitTransitionFinish","e","propertyName","onClose","_this$props$onClose","stopPropagation","i","platform","Component","createScopedElement","href","vkuiClass","mode","onClick","onItemClick","key","target","title","viewWidth","DESKTOP","size","element","createRef","state","eventHandler","supported","current","removeEventListener","name","addEventListener","transitionFinishTimeout","clearTimeout","setTimeout","bind","timeout","header","weight","level","text","actions","actionsLayout","children","className","style","restProps","resolvedActionsLayout","canShowCloseButton","SMALL_TABLET","isDesktop","getRootRef","renderHeader","renderText","map","renderAction","Alert"],"sources":["../../../src/components/Alert/Alert.tsx"],"sourcesContent":["import * as React from \"react\";\nimport Tappable from \"../Tappable/Tappable\";\nimport { PopoutWrapper } from \"../PopoutWrapper/PopoutWrapper\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { classNames } from \"../../lib/classNames\";\nimport { transitionEvent } from \"../../lib/supportEvents\";\nimport { ANDROID, VKCOM, IOS } from \"../../lib/platform\";\nimport { HasPlatform } from \"../../types\";\nimport { withPlatform } from \"../../hoc/withPlatform\";\nimport { withAdaptivity, ViewWidth } from \"../../hoc/withAdaptivity\";\nimport Button, { ButtonProps } from \"../Button/Button\";\nimport { hasReactNode } from \"../../lib/utils\";\nimport Headline from \"../Typography/Headline/Headline\";\nimport Title from \"../Typography/Title/Title\";\nimport { Caption } from \"../Typography/Caption/Caption\";\nimport ModalDismissButton from \"../ModalDismissButton/ModalDismissButton\";\nimport { FocusTrap } from \"../FocusTrap/FocusTrap\";\nimport {\n  AdaptivityContextInterface,\n  AdaptivityProps,\n} from \"../AdaptivityProvider/AdaptivityContext\";\nimport \"./Alert.css\";\n\nexport type AlertActionInterface = AlertAction &\n  React.AnchorHTMLAttributes<HTMLElement>;\n\nexport interface AlertAction extends Pick<ButtonProps, \"Component\" | \"href\"> {\n  title: string;\n  action?: VoidFunction;\n  autoclose?: boolean;\n  mode: \"cancel\" | \"destructive\" | \"default\";\n}\n\nexport interface AlertProps\n  extends React.HTMLAttributes<HTMLElement>,\n    HasPlatform,\n    AdaptivityProps {\n  actionsLayout?: \"vertical\" | \"horizontal\";\n  actions?: AlertAction[];\n  header?: React.ReactNode;\n  text?: React.ReactNode;\n  onClose?: VoidFunction;\n}\n\nexport type TAlertProps = AlertProps & AdaptivityContextInterface;\n\nexport interface AlertState {\n  closing: boolean;\n}\n\ntype TransitionEndHandler = (e?: TransitionEvent) => void;\n\ntype ItemClickHander = (item: AlertActionInterface) => () => void;\n\nclass AlertComponent extends React.Component<TAlertProps, AlertState> {\n  constructor(props: TAlertProps) {\n    super(props);\n    this.element = React.createRef();\n    this.state = {\n      closing: false,\n    };\n  }\n\n  element: React.RefObject<HTMLDivElement>;\n\n  private transitionFinishTimeout: number | undefined = undefined;\n\n  static defaultProps: Partial<TAlertProps> = {\n    actionsLayout: \"horizontal\",\n    actions: [],\n  };\n\n  private get timeout(): number {\n    return this.props.platform === ANDROID || this.props.platform === VKCOM\n      ? 200\n      : 300;\n  }\n\n  onItemClick: ItemClickHander = (item: AlertActionInterface) => () => {\n    const { action, autoclose } = item;\n\n    if (autoclose) {\n      this.setState({ closing: true });\n      this.waitTransitionFinish((e?: TransitionEvent) => {\n        if (!e || e.propertyName === \"opacity\") {\n          autoclose && this.props.onClose?.();\n          action && action();\n        }\n      });\n    } else {\n      action && action();\n    }\n  };\n\n  onClose: VoidFunction = () => {\n    this.setState({ closing: true });\n    this.waitTransitionFinish((e?: TransitionEvent) => {\n      if (!e || e.propertyName === \"opacity\") {\n        this.props.onClose?.();\n      }\n    });\n  };\n\n  stopPropagation: React.MouseEventHandler = (e: React.SyntheticEvent) => {\n    e.stopPropagation();\n  };\n\n  waitTransitionFinish(eventHandler: TransitionEndHandler) {\n    if (transitionEvent.supported && this.element.current) {\n      this.element.current.removeEventListener(\n        transitionEvent.name as string,\n        eventHandler as () => void\n      );\n      this.element.current.addEventListener(\n        transitionEvent.name as string,\n        eventHandler as () => void\n      );\n    } else {\n      if (this.transitionFinishTimeout) {\n        clearTimeout(this.transitionFinishTimeout);\n      }\n      this.transitionFinishTimeout = setTimeout(\n        eventHandler.bind(this),\n        this.timeout\n      );\n    }\n  }\n\n  renderHeader(header: React.ReactNode) {\n    switch (this.props.platform) {\n      case VKCOM:\n        return (\n          <Headline vkuiClass=\"Alert__header\" weight=\"medium\">\n            {header}\n          </Headline>\n        );\n      case IOS:\n        return (\n          <Title vkuiClass=\"Alert__header\" weight=\"1\" level=\"3\">\n            {header}\n          </Title>\n        );\n      case ANDROID:\n        return (\n          <Title vkuiClass=\"Alert__header\" weight=\"2\" level=\"2\">\n            {header}\n          </Title>\n        );\n      default:\n        return undefined;\n    }\n  }\n\n  renderText(text: React.ReactNode) {\n    switch (this.props.platform) {\n      case VKCOM:\n        return <Caption vkuiClass=\"Alert__text\">{text}</Caption>;\n      case IOS:\n        return (\n          <Caption vkuiClass=\"Alert__text\" level=\"2\">\n            {text}\n          </Caption>\n        );\n      case ANDROID:\n        return (\n          <Headline vkuiClass=\"Alert__text\" weight=\"regular\">\n            {text}\n          </Headline>\n        );\n      default:\n        return undefined;\n    }\n  }\n\n  renderAction = (action: AlertActionInterface, i: number) => {\n    const { platform } = this.props;\n\n    if (platform === IOS) {\n      const { Component = \"button\" } = action;\n      return (\n        <Tappable\n          Component={action.href ? \"a\" : Component}\n          vkuiClass={classNames(\n            \"Alert__action\",\n            `Alert__action--${action.mode}`\n          )}\n          onClick={this.onItemClick(action)}\n          href={action.href}\n          key={`alert-action-${i}`}\n          target={action.target}\n        >\n          {action.title}\n        </Tappable>\n      );\n    }\n\n    let mode: ButtonProps[\"mode\"] =\n      action.mode === \"cancel\" ? \"secondary\" : \"primary\";\n\n    if (platform === ANDROID) {\n      mode = \"tertiary\";\n\n      if (\n        this.props.viewWidth === ViewWidth.DESKTOP &&\n        action.mode === \"destructive\"\n      ) {\n        mode = \"destructive\";\n      }\n    }\n\n    return (\n      <Button\n        vkuiClass={classNames(\"Alert__button\", `Alert__button--${action.mode}`)}\n        mode={mode}\n        size=\"m\"\n        onClick={this.onItemClick(action)}\n        Component={action.Component}\n        href={action.href}\n        key={`alert-action-${i}`}\n        target={action.target}\n      >\n        {action.title}\n      </Button>\n    );\n  };\n\n  render() {\n    const {\n      actions,\n      actionsLayout,\n      children,\n      className,\n      style,\n      platform,\n      viewWidth,\n      text,\n      header,\n      ...restProps\n    } = this.props;\n    const { closing } = this.state;\n\n    const resolvedActionsLayout: TAlertProps[\"actionsLayout\"] =\n      platform === VKCOM ? \"horizontal\" : actionsLayout;\n    const canShowCloseButton =\n      platform === VKCOM ||\n      (platform === ANDROID && viewWidth >= ViewWidth.SMALL_TABLET);\n    const isDesktop = viewWidth >= ViewWidth.SMALL_TABLET;\n\n    return (\n      <PopoutWrapper\n        className={className}\n        closing={closing}\n        style={style}\n        onClick={this.onClose}\n      >\n        <FocusTrap\n          {...restProps}\n          getRootRef={this.element}\n          onClick={this.stopPropagation}\n          onClose={this.onClose}\n          timeout={this.timeout}\n          vkuiClass={classNames(getClassName(\"Alert\", platform), {\n            \"Alert--v\": resolvedActionsLayout === \"vertical\",\n            \"Alert--h\": resolvedActionsLayout === \"horizontal\",\n            \"Alert--closing\": closing,\n            \"Alert--desktop\": isDesktop,\n          })}\n        >\n          {canShowCloseButton && <ModalDismissButton onClick={this.onClose} />}\n          <div vkuiClass=\"Alert__content\">\n            {hasReactNode(header) && this.renderHeader(header)}\n            {hasReactNode(text) && this.renderText(text)}\n            {children}\n          </div>\n          <footer vkuiClass=\"Alert__actions\">\n            {actions?.map(this.renderAction)}\n          </footer>\n        </FocusTrap>\n      </PopoutWrapper>\n    );\n  }\n}\n\nexport const Alert = withPlatform(\n  withAdaptivity(AlertComponent, {\n    viewWidth: true,\n  })\n);\n"]},"metadata":{},"sourceType":"module"}