{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"size\", \"name\", \"options\", \"getRootRef\", \"onChange\", \"value\", \"defaultValue\", \"children\"],\n    _excluded2 = [\"label\"];\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { generateRandomId, noop } from \"../../lib/utils\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { SegmentedControlOption } from \"./SegmentedControlOption/SegmentedControlOption\";\nvar warn = warnOnce(\"SegmentedControl\");\nexport var SegmentedControl = function SegmentedControl(_ref) {\n  var _ref$size = _ref.size,\n      size = _ref$size === void 0 ? \"l\" : _ref$size,\n      name = _ref.name,\n      options = _ref.options,\n      getRootRef = _ref.getRootRef,\n      _ref$onChange = _ref.onChange,\n      onChange = _ref$onChange === void 0 ? noop : _ref$onChange,\n      value = _ref.value,\n      defaultValue = _ref.defaultValue,\n      children = _ref.children,\n      restProps = _objectWithoutProperties(_ref, _excluded);\n\n  var initialValue = defaultValue !== null && defaultValue !== void 0 ? defaultValue : value;\n\n  if (!initialValue) {\n    var _options$;\n\n    initialValue = (_options$ = options[0]) === null || _options$ === void 0 ? void 0 : _options$.value;\n  }\n\n  var _React$useState = React.useState(0),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      activeOptionIdx = _React$useState2[0],\n      updateActiveOptionIdx = _React$useState2[1];\n\n  var _React$useState3 = React.useState(initialValue),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      activeValue = _React$useState4[0],\n      updateActiveValue = _React$useState4[1];\n\n  var nameRef = React.useRef(name !== null && name !== void 0 ? name : generateRandomId());\n  useIsomorphicLayoutEffect(function () {\n    var _activeOptionIdx = options.findIndex(function (option) {\n      return option.value === activeValue;\n    });\n\n    if (_activeOptionIdx === -1 && process.env.NODE_ENV === \"development\") {\n      warn(\"defaultValue: такого значения нет среди опций!\");\n    }\n\n    updateActiveOptionIdx(_activeOptionIdx);\n  }, [activeValue, options]);\n  var translateX = \"translateX(\".concat(100 * activeOptionIdx, \"%)\");\n\n  var handleOnChange = function handleOnChange(value) {\n    updateActiveValue(value);\n    onChange(value);\n  };\n\n  return createScopedElement(\"div\", _extends({}, restProps, {\n    vkuiClass: classNames(\"SegmentedControl\", \"SegmentedControl--\".concat(size)),\n    ref: getRootRef\n  }), createScopedElement(\"div\", {\n    role: \"radiogroup\",\n    vkuiClass: \"SegmentedControl__in\"\n  }, activeOptionIdx > -1 && createScopedElement(\"div\", {\n    \"aria-hidden\": \"true\",\n    vkuiClass: \"SegmentedControl__slider\",\n    style: {\n      width: \"\".concat(100 / options.length, \"%\"),\n      transform: translateX,\n      WebkitTransform: translateX\n    }\n  }), options.map(function (_ref2) {\n    var label = _ref2.label,\n        optionProps = _objectWithoutProperties(_ref2, _excluded2);\n\n    return createScopedElement(SegmentedControlOption, _extends({\n      key: \"\".concat(optionProps.value)\n    }, optionProps, {\n      vkuiClass: \"SegmentedControl__option\",\n      name: nameRef.current,\n      checked: activeValue === optionProps.value,\n      onChange: function onChange() {\n        return handleOnChange(optionProps.value);\n      }\n    }), label);\n  })));\n};","map":{"version":3,"mappings":"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","names":["React","classNames","useIsomorphicLayoutEffect","generateRandomId","noop","warnOnce","SegmentedControlOption","warn","SegmentedControl","size","name","options","getRootRef","onChange","value","defaultValue","children","restProps","initialValue","_options$","useState","activeOptionIdx","updateActiveOptionIdx","activeValue","updateActiveValue","nameRef","useRef","_activeOptionIdx","findIndex","option","process","env","NODE_ENV","translateX","handleOnChange","createScopedElement","vkuiClass","ref","role","style","width","length","transform","WebkitTransform","map","label","optionProps","key","current","checked"],"sources":["../../../src/components/SegmentedControl/SegmentedControl.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { generateRandomId, noop } from \"../../lib/utils\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { SegmentedControlOption } from \"./SegmentedControlOption/SegmentedControlOption\";\nimport { HasRootRef } from \"../../types\";\nimport \"./SegmentedControl.css\";\n\nexport type SegmentedControlValue = string | number | undefined;\n\nexport interface SegmentedControlOptionInterface\n  extends Omit<React.HTMLAttributes<HTMLElement>, \"label\"> {\n  label: React.ReactChild;\n  value: SegmentedControlValue;\n}\n\nexport interface SegmentedControlProps\n  extends Omit<React.HTMLAttributes<HTMLDivElement>, \"onChange\">,\n    HasRootRef<HTMLDivElement> {\n  options: SegmentedControlOptionInterface[];\n  size?: \"m\" | \"l\";\n  name?: string;\n  onChange?: (value: SegmentedControlValue) => void;\n  value?: SegmentedControlValue;\n  defaultValue?: SegmentedControlValue;\n}\n\nconst warn = warnOnce(\"SegmentedControl\");\nexport const SegmentedControl: React.FC<SegmentedControlProps> = ({\n  size = \"l\",\n  name,\n  options,\n  getRootRef,\n  onChange = noop,\n  value,\n  defaultValue,\n  children,\n  ...restProps\n}) => {\n  let initialValue = defaultValue ?? value;\n\n  if (!initialValue) {\n    initialValue = options[0]?.value;\n  }\n\n  const [activeOptionIdx, updateActiveOptionIdx] = React.useState<number>(0);\n  const [activeValue, updateActiveValue] =\n    React.useState<SegmentedControlValue>(initialValue);\n\n  const nameRef = React.useRef<string>(name ?? generateRandomId());\n\n  useIsomorphicLayoutEffect(() => {\n    const _activeOptionIdx = options.findIndex(\n      (option) => option.value === activeValue\n    );\n\n    if (_activeOptionIdx === -1 && process.env.NODE_ENV === \"development\") {\n      warn(\"defaultValue: такого значения нет среди опций!\");\n    }\n\n    updateActiveOptionIdx(_activeOptionIdx);\n  }, [activeValue, options]);\n\n  const translateX = `translateX(${100 * activeOptionIdx}%)`;\n\n  const handleOnChange = (value: SegmentedControlValue) => {\n    updateActiveValue(value);\n    onChange(value);\n  };\n\n  return (\n    <div\n      {...restProps}\n      vkuiClass={classNames(\"SegmentedControl\", `SegmentedControl--${size}`)}\n      ref={getRootRef}\n    >\n      <div role=\"radiogroup\" vkuiClass=\"SegmentedControl__in\">\n        {activeOptionIdx > -1 && (\n          <div\n            aria-hidden=\"true\"\n            vkuiClass=\"SegmentedControl__slider\"\n            style={{\n              width: `${100 / options.length}%`,\n              transform: translateX,\n              WebkitTransform: translateX,\n            }}\n          />\n        )}\n        {options.map(({ label, ...optionProps }) => (\n          <SegmentedControlOption\n            key={`${optionProps.value}`}\n            {...optionProps}\n            vkuiClass=\"SegmentedControl__option\"\n            name={nameRef.current}\n            checked={activeValue === optionProps.value}\n            onChange={() => handleOnChange(optionProps.value)}\n          >\n            {label}\n          </SegmentedControlOption>\n        ))}\n      </div>\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}