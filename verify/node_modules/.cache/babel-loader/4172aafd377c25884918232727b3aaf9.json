{"ast":null,"code":"export function pkcs7Pad(data) {\n  const padder = 16 - data.length % 16;\n  const result = new Uint8Array(data.length + padder);\n  result.set(data);\n\n  for (let i = data.length; i < result.length; i++) {\n    result[i] = padder;\n  }\n\n  return result;\n}\nexport function pkcs7Strip(data) {\n  if (data.length < 16) {\n    throw new TypeError('PKCS#7 invalid length');\n  }\n\n  const padder = data[data.length - 1];\n\n  if (padder > 16) {\n    throw new TypeError('PKCS#7 padding byte out of range');\n  }\n\n  const length = data.length - padder;\n\n  for (let i = 0; i < padder; i++) {\n    if (data[length + i] !== padder) {\n      throw new TypeError('PKCS#7 invalid padding byte');\n    }\n  }\n\n  return new Uint8Array(data.subarray(0, length));\n}","map":{"version":3,"mappings":"AACA,OAAM,SAAUA,QAAV,CAAmBC,IAAnB,EAAmC;AACrC,QAAMC,MAAM,GAAG,KAAMD,IAAI,CAACE,MAAL,GAAc,EAAnC;AAEA,QAAMC,MAAM,GAAG,IAAIC,UAAJ,CAAeJ,IAAI,CAACE,MAAL,GAAcD,MAA7B,CAAf;AACAE,QAAM,CAACE,GAAP,CAAWL,IAAX;;AAEA,OAAK,IAAIM,CAAC,GAAGN,IAAI,CAACE,MAAlB,EAA0BI,CAAC,GAAGH,MAAM,CAACD,MAArC,EAA6CI,CAAC,EAA9C,EAAkD;AAC9CH,UAAM,CAACG,CAAD,CAAN,GAAYL,MAAZ;AACH;;AAED,SAAOE,MAAP;AACH;AAED,OAAM,SAAUI,UAAV,CAAqBP,IAArB,EAAqC;AACvC,MAAIA,IAAI,CAACE,MAAL,GAAc,EAAlB,EAAsB;AAAE,UAAM,IAAIM,SAAJ,CAAc,uBAAd,CAAN;AAA+C;;AAEvE,QAAMP,MAAM,GAAGD,IAAI,CAACA,IAAI,CAACE,MAAL,GAAc,CAAf,CAAnB;;AACA,MAAID,MAAM,GAAG,EAAb,EAAiB;AAAE,UAAM,IAAIO,SAAJ,CAAc,kCAAd,CAAN;AAA0D;;AAE7E,QAAMN,MAAM,GAAGF,IAAI,CAACE,MAAL,GAAcD,MAA7B;;AACA,OAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,MAApB,EAA4BK,CAAC,EAA7B,EAAiC;AAC7B,QAAIN,IAAI,CAACE,MAAM,GAAGI,CAAV,CAAJ,KAAqBL,MAAzB,EAAiC;AAC7B,YAAM,IAAIO,SAAJ,CAAc,6BAAd,CAAN;AACH;AACJ;;AAED,SAAO,IAAIJ,UAAJ,CAAeJ,IAAI,CAACS,QAAL,CAAc,CAAd,EAAiBP,MAAjB,CAAf,CAAP;AACH","names":["pkcs7Pad","data","padder","length","result","Uint8Array","set","i","pkcs7Strip","TypeError","subarray"],"sourceRoot":"","sources":["../src.ts/padding.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}