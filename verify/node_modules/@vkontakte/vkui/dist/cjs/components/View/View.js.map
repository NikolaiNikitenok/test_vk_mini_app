{"version":3,"sources":["../../../../src/components/View/View.tsx"],"names":["SwipeBackResults","scrollsCache","warn","View","props","undefined","e","includes","animationName","state","prevPanel","flushTransition","Boolean","isBack","propertyName","target","pickPanel","swipeBackNextPanel","swipeBackResult","fail","onSwipeBackCancel","success","onSwipeBackSuccess","platform","configProvider","IOS","isWebView","startX","window","innerWidth","browserSwipe","setState","onSwipeBack","animated","swipingBack","history","length","activePanel","scrolls","scroll","getScroll","y","swipebackStartX","swipeBackPrevPanel","slice","swipeBackShift","shiftX","speed","duration","visiblePanels","nextPanel","document","React","Children","toArray","children","process","env","NODE_ENV","popout","modal","id","prevProps","prevState","blurActiveElement","firstLayerId","panels","map","panel","find","shouldDisableTransitionMotion","animationEvent","supported","animationFinishTimeout","clearTimeout","setTimeout","transitionEndHandler","ANDROID","VKCOM","scrollTo","onTransition","from","to","onSwipeBackStart","waitTransitionFinish","swipingBackTransitionEndHandler","transitionMotionEnabled","splitCol","animate","elem","eventHandler","transitionEvent","name","removeEventListener","addEventListener","transitionFinishTimeout","activeElement","blur","panelNodes","panelId","canUseDOM","isPrev","isNext","prevPanelTranslate","nextPanelTranslate","prevPanelShadow","boxShadow","transform","WebkitTransform","_1","nav","restProps","hasPopout","hasModal","filter","disableAnimation","modifiers","onMoveX","onEnd","isTransitionTarget","compensateScroll","el","calcPanelSwipeStyles","marginTop","Component","SplitColContext","ConfigProviderContext","ScrollContext"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport { transitionEvent, animationEvent } from \"../../lib/supportEvents\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { IOS, ANDROID, VKCOM } from \"../../lib/platform\";\nimport { Touch, TouchEvent } from \"../Touch/Touch\";\nimport { HasPlatform } from \"../../types\";\nimport { withPlatform } from \"../../hoc/withPlatform\";\nimport { withContext } from \"../../hoc/withContext\";\nimport {\n  ConfigProviderContext,\n  ConfigProviderContextInterface,\n} from \"../ConfigProvider/ConfigProviderContext\";\nimport { SplitColContext, SplitColContextProps } from \"../SplitCol/SplitCol\";\nimport { AppRootPortal } from \"../AppRoot/AppRootPortal\";\nimport { canUseDOM, withDOM, DOMProps } from \"../../lib/dom\";\nimport {\n  ScrollContext,\n  ScrollContextInterface,\n} from \"../AppRoot/ScrollContext\";\nimport { NavTransitionProvider } from \"../NavTransitionContext/NavTransitionContext\";\nimport { getNavId, NavIdProps } from \"../../lib/getNavId\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { swipeBackExcluded } from \"./utils\";\nimport \"./View.css\";\n\nenum SwipeBackResults {\n  fail = 1,\n  success,\n}\n\ninterface Scrolls {\n  [index: string]: number | undefined;\n}\n\ninterface ViewsScrolls {\n  [index: string]: Scrolls;\n}\n\ntype TransitionEventHandler = (e?: TransitionEvent) => void;\n\nexport let scrollsCache: ViewsScrolls = {};\n\nexport interface ViewProps\n  extends React.HTMLAttributes<HTMLElement>,\n    HasPlatform,\n    NavIdProps {\n  activePanel: string;\n  /**\n   * @deprecated будет удалено в 5.0.0. Используйте одноименное свойство у `SplitLayout`.\n   *\n   * Свойство для отрисовки `Alert`, `ActionSheet` и `ScreenSpinner`.\n   */\n  popout?: React.ReactNode;\n  /**\n   * @deprecated будет удалено в 5.0.0. Используйте одноименное свойство у `SplitLayout`.\n   *\n   * Свойство для отрисовки `ModalRoot`.\n   */\n  modal?: React.ReactNode;\n  onTransition?(params: { isBack: boolean; from: string; to: string }): void;\n  /**\n   * callback свайпа назад\n   */\n  onSwipeBack?(): void;\n  /**\n   * callback начала анимации свайпа назад.\n   */\n  onSwipeBackStart?(): void;\n  /**\n   * callback завершения анимации отмененного пользователем свайпа\n   */\n  onSwipeBackCancel?(): void;\n  history?: string[];\n  /**\n   * @ignore\n   */\n  splitCol?: SplitColContextProps;\n  /**\n   * @ignore\n   */\n  configProvider?: ConfigProviderContextInterface;\n  /**\n   * @ignore\n   */\n  scroll?: ScrollContextInterface;\n}\n\nexport interface ViewState {\n  animated: boolean;\n\n  visiblePanels: string[];\n  activePanel: string | null;\n  isBack: boolean | undefined;\n  prevPanel: string | null;\n  nextPanel: string | null;\n\n  swipingBack: boolean;\n  swipebackStartX: number;\n  swipeBackShift: number;\n  swipeBackNextPanel: string | null;\n  swipeBackPrevPanel: string | null;\n  swipeBackResult: SwipeBackResults | null;\n\n  browserSwipe: boolean;\n}\n\nconst warn = warnOnce(\"View\");\nclass View extends React.Component<ViewProps & DOMProps, ViewState> {\n  constructor(props: ViewProps) {\n    super(props);\n\n    this.state = {\n      animated: false,\n\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n\n      swipingBack: false,\n      swipebackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipeBackResult: null,\n\n      browserSwipe: false,\n    };\n  }\n\n  static defaultProps: Partial<ViewProps> = {\n    history: [],\n  };\n\n  private readonly scrolls = scrollsCache[getNavId(this.props) as string] || {};\n  private transitionFinishTimeout: number | undefined = undefined;\n  private animationFinishTimeout: number | undefined = undefined;\n\n  get document() {\n    return this.props.document;\n  }\n\n  get window() {\n    return this.props.window;\n  }\n\n  get panels() {\n    return React.Children.toArray(this.props.children) as React.ReactElement[];\n  }\n\n  panelNodes: { [id: string]: HTMLDivElement | null } = {};\n\n  componentDidMount() {\n    if (process.env.NODE_ENV === \"development\") {\n      const { popout, modal } = this.props;\n      popout &&\n        warn(\n          \"Свойство popout устарело и будет удалено в 5.0.0. Используйте одноименное свойство у SplitLayout.\"\n        );\n      modal &&\n        warn(\n          \"Свойство modal устарело и будет удалено в 5.0.0. Используйте одноименное свойство у SplitLayout.\"\n        );\n    }\n  }\n\n  componentWillUnmount() {\n    const id = getNavId(this.props);\n    if (id) {\n      scrollsCache[id] = this.scrolls;\n    }\n  }\n\n  componentDidUpdate(prevProps: ViewProps, prevState: ViewState) {\n    this.props.popout && !prevProps.popout && this.blurActiveElement();\n    this.props.modal && !prevProps.modal && this.blurActiveElement();\n\n    // Нужен переход\n    if (\n      prevProps.activePanel !== this.props.activePanel &&\n      !prevState.swipingBack &&\n      !prevState.browserSwipe\n    ) {\n      const firstLayerId = this.panels\n        .map((panel) => getNavId(panel.props, warn))\n        .find(\n          (id) => id === prevProps.activePanel || id === this.props.activePanel\n        );\n\n      const isBack = firstLayerId === this.props.activePanel;\n      this.scrolls[prevProps.activePanel] = this.props.scroll?.getScroll().y;\n\n      if (this.shouldDisableTransitionMotion()) {\n        this.flushTransition(prevProps.activePanel, isBack);\n      } else {\n        this.blurActiveElement();\n\n        this.setState({\n          visiblePanels: [prevProps.activePanel, this.props.activePanel],\n          prevPanel: prevProps.activePanel,\n          nextPanel: this.props.activePanel,\n          activePanel: null,\n          animated: true,\n          isBack,\n        });\n\n        // Фолбек анимации перехода\n        if (!animationEvent.supported) {\n          if (this.animationFinishTimeout) {\n            clearTimeout(this.animationFinishTimeout);\n          }\n          this.animationFinishTimeout = setTimeout(\n            this.transitionEndHandler,\n            this.props.platform === ANDROID || this.props.platform === VKCOM\n              ? 300\n              : 600\n          );\n        }\n      }\n    }\n\n    // Закончилась анимация свайпа назад\n    if (\n      prevProps.activePanel !== this.props.activePanel &&\n      prevState.swipingBack\n    ) {\n      const nextPanel = this.props.activePanel;\n      const prevPanel = prevProps.activePanel;\n      if (prevState.swipeBackPrevPanel !== null) {\n        this.scrolls[prevState.swipeBackPrevPanel] = 0;\n      }\n      this.setState(\n        {\n          swipeBackPrevPanel: null,\n          swipeBackNextPanel: null,\n          swipingBack: false,\n          swipeBackResult: null,\n          swipebackStartX: 0,\n          swipeBackShift: 0,\n          activePanel: nextPanel,\n          visiblePanels: [nextPanel],\n        },\n        () => {\n          if (this.state.activePanel !== null) {\n            this.props.scroll?.scrollTo(\n              0,\n              this.scrolls[this.state.activePanel]\n            );\n          }\n          prevProps.onTransition &&\n            prevProps.onTransition({\n              isBack: true,\n              from: prevPanel,\n              to: nextPanel,\n            });\n        }\n      );\n    }\n\n    // Начался свайп назад\n    if (!prevState.swipingBack && this.state.swipingBack) {\n      this.props.onSwipeBackStart && this.props.onSwipeBackStart();\n    }\n\n    // Началась анимация завершения свайпа назад.\n    if (!prevState.swipeBackResult && this.state.swipeBackResult) {\n      this.waitTransitionFinish(\n        this.pickPanel(this.state.swipeBackNextPanel),\n        this.swipingBackTransitionEndHandler\n      );\n    }\n\n    // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n    if (\n      prevState.swipeBackResult === SwipeBackResults.fail &&\n      !this.state.swipeBackResult &&\n      this.state.activePanel !== null\n    ) {\n      this.props.scroll?.scrollTo(0, this.scrolls[this.state.activePanel]);\n    }\n\n    // Закончился Safari свайп\n    if (\n      prevProps.activePanel !== this.props.activePanel &&\n      this.state.browserSwipe\n    ) {\n      this.setState({\n        browserSwipe: false,\n        nextPanel: null,\n        prevPanel: null,\n        animated: false,\n        visiblePanels: [this.props.activePanel],\n        activePanel: this.props.activePanel,\n      });\n    }\n  }\n\n  shouldDisableTransitionMotion(): boolean {\n    return (\n      this.props.configProvider?.transitionMotionEnabled === false ||\n      !this.props.splitCol?.animate\n    );\n  }\n\n  waitTransitionFinish(\n    elem: HTMLElement | null | undefined,\n    eventHandler: TransitionEventHandler\n  ): void {\n    if (transitionEvent.supported && transitionEvent.name && elem) {\n      elem.removeEventListener(\n        transitionEvent.name as keyof HTMLElementEventMap,\n        eventHandler as EventListener\n      );\n      elem.addEventListener(\n        transitionEvent.name as keyof HTMLElementEventMap,\n        eventHandler as EventListener\n      );\n    } else {\n      if (this.transitionFinishTimeout) {\n        clearTimeout(this.transitionFinishTimeout);\n      }\n      this.transitionFinishTimeout = setTimeout(\n        eventHandler,\n        this.props.platform === ANDROID || this.props.platform === VKCOM\n          ? 300\n          : 600\n      );\n    }\n  }\n\n  blurActiveElement(): void {\n    if (typeof this.window !== \"undefined\" && this.document?.activeElement) {\n      (this.document.activeElement as HTMLElement).blur();\n    }\n  }\n\n  pickPanel(id: string | null) {\n    if (id === null) {\n      return undefined;\n    }\n    return this.panelNodes[id];\n  }\n\n  flushTransition(prevPanel: string, isBack: boolean) {\n    const activePanel = this.props.activePanel;\n    if (isBack) {\n      this.scrolls[prevPanel] = 0;\n    }\n    this.setState(\n      {\n        prevPanel: null,\n        nextPanel: null,\n        visiblePanels: [activePanel],\n        activePanel,\n        animated: false,\n        isBack: undefined,\n      },\n      () => {\n        this.props.scroll?.scrollTo(0, isBack ? this.scrolls[activePanel] : 0);\n        this.props.onTransition &&\n          this.props.onTransition({ isBack, from: prevPanel, to: activePanel });\n      }\n    );\n  }\n\n  transitionEndHandler = (e?: React.AnimationEvent): void => {\n    if (\n      (!e ||\n        [\n          \"vkui-animation-ios-next-forward\",\n          \"vkui-animation-ios-prev-back\",\n          \"vkui-animation-view-next-forward\",\n          \"vkui-animation-view-prev-back\",\n        ].includes(e.animationName)) &&\n      this.state.prevPanel !== null\n    ) {\n      this.flushTransition(this.state.prevPanel, Boolean(this.state.isBack));\n    }\n  };\n\n  swipingBackTransitionEndHandler = (e?: TransitionEvent): void => {\n    // indexOf because of vendor prefixes in old browsers\n    if (\n      !e ||\n      (e?.propertyName.includes(\"transform\") &&\n        e?.target === this.pickPanel(this.state.swipeBackNextPanel))\n    ) {\n      switch (this.state.swipeBackResult) {\n        case SwipeBackResults.fail:\n          this.onSwipeBackCancel();\n          break;\n        case SwipeBackResults.success:\n          this.onSwipeBackSuccess();\n      }\n    }\n  };\n\n  onSwipeBackSuccess(): void {\n    this.props.onSwipeBack && this.props.onSwipeBack();\n  }\n\n  onSwipeBackCancel(): void {\n    this.props.onSwipeBackCancel && this.props.onSwipeBackCancel();\n    this.setState({\n      swipeBackPrevPanel: null,\n      swipeBackNextPanel: null,\n      swipingBack: false,\n      swipeBackResult: null,\n      swipebackStartX: 0,\n      swipeBackShift: 0,\n    });\n  }\n\n  onMoveX = (e: TouchEvent): void => {\n    if (swipeBackExcluded(e)) {\n      return;\n    }\n\n    const { platform, configProvider } = this.props;\n\n    if (\n      platform === IOS &&\n      !configProvider?.isWebView &&\n      (e.startX <= 70 || e.startX >= this.window!.innerWidth - 70) &&\n      !this.state.browserSwipe\n    ) {\n      this.setState({ browserSwipe: true });\n    }\n\n    if (\n      platform === IOS &&\n      configProvider?.isWebView &&\n      this.props.onSwipeBack\n    ) {\n      if ((this.state.animated && e.startX <= 70) || !this.window) {\n        return;\n      }\n\n      if (\n        e.startX <= 70 &&\n        !this.state.swipingBack &&\n        (this.props.history?.length ?? 0) > 1\n      ) {\n        if (this.state.activePanel !== null) {\n          this.scrolls[this.state.activePanel] =\n            this.props.scroll?.getScroll().y;\n        }\n        this.setState({\n          swipingBack: true,\n          swipebackStartX: e.startX,\n          swipeBackPrevPanel: this.state.activePanel,\n          swipeBackNextPanel: this.props.history!.slice(-2)[0],\n        });\n      }\n      if (this.state.swipingBack) {\n        let swipeBackShift = 0;\n        if (e.shiftX < 0) {\n          swipeBackShift = 0;\n        } else if (\n          e.shiftX >\n          this.window.innerWidth - this.state.swipebackStartX\n        ) {\n          swipeBackShift = this.window?.innerWidth;\n        } else {\n          swipeBackShift = e.shiftX;\n        }\n        this.setState({ swipeBackShift });\n      }\n    }\n  };\n\n  onEnd = (e: TouchEvent): void => {\n    if (this.state.swipingBack && this.window) {\n      const speed = (this.state.swipeBackShift / e.duration) * 1000;\n      if (this.state.swipeBackShift === 0) {\n        this.onSwipeBackCancel();\n      } else if (this.state.swipeBackShift >= (this.window?.innerWidth ?? 0)) {\n        this.onSwipeBackSuccess();\n      } else if (\n        speed > 250 ||\n        this.state.swipebackStartX + this.state.swipeBackShift >\n          this.window.innerWidth / 2\n      ) {\n        this.setState({ swipeBackResult: SwipeBackResults.success });\n      } else {\n        this.setState({ swipeBackResult: SwipeBackResults.fail });\n      }\n    }\n  };\n\n  calcPanelSwipeStyles(panelId: string | undefined): React.CSSProperties {\n    if (!canUseDOM || !this.window) {\n      return {};\n    }\n\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if ((!isPrev && !isNext) || this.state.swipeBackResult) {\n      return {};\n    }\n\n    let prevPanelTranslate = `${this.state.swipeBackShift}px`;\n    let nextPanelTranslate = `${\n      -50 + (this.state.swipeBackShift * 100) / this.window.innerWidth / 2\n    }%`;\n    let prevPanelShadow =\n      (0.3 * (this.window.innerWidth - this.state.swipeBackShift)) /\n      this.window.innerWidth;\n\n    if (this.state.swipeBackResult) {\n      return isPrev\n        ? { boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})` }\n        : {};\n    }\n\n    if (isNext) {\n      return {\n        transform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n      };\n    }\n    if (isPrev) {\n      return {\n        transform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})`,\n      };\n    }\n\n    return {};\n  }\n\n  render() {\n    const {\n      popout,\n      modal,\n      platform,\n      activePanel: _1,\n      splitCol,\n      configProvider,\n      history,\n      nav,\n      onTransition,\n      onSwipeBack,\n      onSwipeBackStart,\n      onSwipeBackCancel,\n      window,\n      document,\n      scroll,\n      ...restProps\n    } = this.props;\n    const {\n      prevPanel,\n      nextPanel,\n      activePanel,\n      swipeBackPrevPanel,\n      swipeBackNextPanel,\n      swipeBackResult,\n      isBack,\n      animated,\n    } = this.state;\n\n    const hasPopout = !!popout;\n    const hasModal = !!modal;\n\n    const panels = this.panels.filter((panel: React.ReactElement) => {\n      const panelId = getNavId(panel.props, warn);\n\n      return (\n        (panelId !== undefined && this.state.visiblePanels.includes(panelId)) ||\n        panelId === swipeBackPrevPanel ||\n        panelId === swipeBackNextPanel\n      );\n    });\n\n    const disableAnimation = this.shouldDisableTransitionMotion();\n\n    const modifiers = {\n      \"View--animated\": !disableAnimation && animated,\n      \"View--swiping-back\": !disableAnimation && this.state.swipingBack,\n      \"View--no-motion\": disableAnimation,\n    };\n\n    return (\n      <Touch\n        Component=\"section\"\n        {...restProps}\n        vkuiClass={classNames(getClassName(\"View\", platform), modifiers)}\n        onMoveX={this.onMoveX}\n        onEnd={this.onEnd}\n      >\n        <div vkuiClass=\"View__panels\">\n          {panels.map((panel: React.ReactElement) => {\n            const panelId = getNavId(panel.props, warn);\n            const isPrev =\n              panelId === prevPanel || panelId === swipeBackPrevPanel;\n            const isTransitionTarget =\n              animated && panelId === (isBack ? prevPanel : nextPanel);\n            const compensateScroll =\n              isPrev ||\n              panelId === swipeBackNextPanel ||\n              (panelId === nextPanel && isBack);\n\n            return (\n              <div\n                vkuiClass={classNames(\"View__panel\", {\n                  \"View__panel--active\": panelId === activePanel,\n                  \"View__panel--prev\": panelId === prevPanel,\n                  \"View__panel--next\": panelId === nextPanel,\n                  \"View__panel--swipe-back-prev\":\n                    panelId === swipeBackPrevPanel,\n                  \"View__panel--swipe-back-next\":\n                    panelId === swipeBackNextPanel,\n                  \"View__panel--swipe-back-success\":\n                    swipeBackResult === SwipeBackResults.success,\n                  \"View__panel--swipe-back-failed\":\n                    swipeBackResult === SwipeBackResults.fail,\n                })}\n                onAnimationEnd={\n                  isTransitionTarget ? this.transitionEndHandler : undefined\n                }\n                ref={(el) =>\n                  panelId !== undefined && (this.panelNodes[panelId] = el)\n                }\n                style={this.calcPanelSwipeStyles(panelId)}\n                key={panelId}\n              >\n                <div\n                  vkuiClass=\"View__panel-in\"\n                  style={{\n                    marginTop: compensateScroll\n                      ? -(this.scrolls[panelId as string] ?? 0)\n                      : undefined,\n                  }}\n                >\n                  <NavTransitionProvider\n                    entering={\n                      panelId === nextPanel || panelId === swipeBackNextPanel\n                    }\n                  >\n                    {panel}\n                  </NavTransitionProvider>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        <AppRootPortal>\n          {hasPopout && <div vkuiClass=\"View__popout\">{popout}</div>}\n          {hasModal && <div vkuiClass=\"View__modal\">{modal}</div>}\n        </AppRootPortal>\n      </Touch>\n    );\n  }\n}\n\n// eslint-disable-next-line import/no-default-export\nexport default withContext(\n  withContext(\n    withContext(\n      withPlatform(withDOM<ViewProps>(View)),\n      SplitColContext,\n      \"splitCol\"\n    ),\n    ConfigProviderContext,\n    \"configProvider\"\n  ),\n  ScrollContext,\n  \"scroll\"\n);\n"],"file":"View.js"}