{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"alt\", \"crossOrigin\", \"decoding\", \"height\", \"loading\", \"referrerPolicy\", \"sizes\", \"src\", \"srcSet\", \"useMap\", \"width\", \"getRef\", \"size\", \"shadow\", \"mode\", \"className\", \"children\", \"getRootRef\", \"style\", \"aria-label\", \"badge\", \"overlayIcon\", \"overlayMode\", \"overlayAction\", \"onClick\"];\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from \"react\";\nimport { Icon12Circle, Icon12OnlineMobile } from \"@vkontakte/icons\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { classNames } from \"../../lib/classNames\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport Tappable from \"../Tappable/Tappable\";\nexport var AVATAR_DEFAULT_SIZE = 48;\nexport var AVATAR_DEFAULT_SHADOW = true;\n\nvar Avatar = function Avatar(_ref) {\n  var alt = _ref.alt,\n      crossOrigin = _ref.crossOrigin,\n      decoding = _ref.decoding,\n      height = _ref.height,\n      loading = _ref.loading,\n      referrerPolicy = _ref.referrerPolicy,\n      sizes = _ref.sizes,\n      src = _ref.src,\n      srcSet = _ref.srcSet,\n      useMap = _ref.useMap,\n      width = _ref.width,\n      getRef = _ref.getRef,\n      _ref$size = _ref.size,\n      size = _ref$size === void 0 ? AVATAR_DEFAULT_SIZE : _ref$size,\n      _ref$shadow = _ref.shadow,\n      shadow = _ref$shadow === void 0 ? AVATAR_DEFAULT_SHADOW : _ref$shadow,\n      _ref$mode = _ref.mode,\n      mode = _ref$mode === void 0 ? \"default\" : _ref$mode,\n      className = _ref.className,\n      children = _ref.children,\n      getRootRef = _ref.getRootRef,\n      style = _ref.style,\n      ariaLabel = _ref[\"aria-label\"],\n      badge = _ref.badge,\n      overlayIcon = _ref.overlayIcon,\n      _ref$overlayMode = _ref.overlayMode,\n      overlayMode = _ref$overlayMode === void 0 ? \"light\" : _ref$overlayMode,\n      passedOverlayAction = _ref.overlayAction,\n      onClick = _ref.onClick,\n      restProps = _objectWithoutProperties(_ref, _excluded);\n\n  var platform = usePlatform();\n\n  var _useAdaptivity = useAdaptivity(),\n      hasMouse = _useAdaptivity.hasMouse;\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      failedImage = _React$useState2[0],\n      setFailedImage = _React$useState2[1];\n\n  var overlayAction = passedOverlayAction !== null && passedOverlayAction !== void 0 ? passedOverlayAction : hasMouse ? \"hover\" : \"always\";\n\n  var onImageError = function onImageError() {\n    setFailedImage(true);\n  };\n\n  var onImageLoad = function onImageLoad() {\n    setFailedImage(false);\n  };\n\n  var borderRadius = \"50%\";\n\n  switch (mode) {\n    case \"image\":\n      size < 64 && (borderRadius = 4);\n      size >= 64 && size < 96 && (borderRadius = 6);\n      size >= 96 && (borderRadius = 8);\n      break;\n\n    case \"app\":\n      size <= 40 && (borderRadius = 8);\n      size > 40 && size < 56 && (borderRadius = 10);\n      size >= 56 && size < 64 && (borderRadius = 12);\n      size >= 64 && size < 84 && (borderRadius = 16);\n      size >= 84 && (borderRadius = 18);\n      break;\n\n    default:\n      break;\n  }\n\n  var hasSrc = src || srcSet;\n  return createScopedElement(\"div\", _extends({}, restProps, {\n    vkuiClass: classNames(getClassName(\"Avatar\", platform), \"Avatar--type-\".concat(mode), \"Avatar--sz-\".concat(size), {\n      \"Avatar--shadow\": shadow,\n      \"Avatar--failed\": failedImage\n    }),\n    className: className,\n    ref: getRootRef,\n    role: hasSrc ? \"img\" : \"presentation\",\n    \"aria-label\": alt || ariaLabel,\n    onClick: !overlayIcon ? onClick : undefined,\n    style: _objectSpread(_objectSpread({}, style), {}, {\n      width: size,\n      height: size,\n      borderRadius: borderRadius\n    })\n  }), hasSrc && createScopedElement(\"img\", {\n    crossOrigin: crossOrigin,\n    decoding: decoding,\n    height: height,\n    loading: loading,\n    referrerPolicy: referrerPolicy,\n    sizes: sizes,\n    src: src,\n    srcSet: srcSet,\n    useMap: useMap,\n    width: width,\n    ref: getRef,\n    onError: onImageError,\n    onLoad: onImageLoad,\n    vkuiClass: \"Avatar__img\",\n    alt: \"\"\n  }), children && createScopedElement(\"div\", {\n    vkuiClass: \"Avatar__children\"\n  }, children), overlayIcon && createScopedElement(Tappable, {\n    Component: \"button\",\n    vkuiClass: classNames(\"Avatar__overlay\", {\n      \"Avatar__overlay--visible\": overlayAction === \"always\",\n      \"Avatar__overlay--light\": overlayMode === \"light\",\n      \"Avatar__overlay--dark\": overlayMode === \"dark\"\n    }),\n    hoverMode: \"Avatar__overlay--visible\",\n    focusVisibleMode: \"Avatar__overlay--focus-visible\",\n    hasActive: false,\n    onClick: onClick\n  }, overlayIcon), badge && createScopedElement(\"div\", {\n    vkuiClass: classNames(\"Avatar__badge\", {\n      \"Avatar__badge--large\": size >= 96,\n      \"Avatar__badge--shadow\": badge !== \"online\" && badge !== \"online-mobile\"\n    })\n  }, badge === \"online\" ? createScopedElement(\"div\", {\n    vkuiClass: \"Avatar__badge-online\"\n  }, createScopedElement(Icon12Circle, {\n    width: size >= 72 ? 15 : 12,\n    height: size >= 72 ? 15 : 12\n  })) : badge === \"online-mobile\" ? createScopedElement(\"div\", {\n    vkuiClass: \"Avatar__badge-online-mobile\"\n  }, createScopedElement(Icon12OnlineMobile, {\n    width: size >= 72 ? 9 : 8,\n    height: size >= 72 ? 15 : 12\n  })) : badge));\n}; // eslint-disable-next-line import/no-default-export\n\n\nexport default Avatar;","map":{"version":3,"mappings":"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","names":["React","Icon12Circle","Icon12OnlineMobile","getClassName","classNames","usePlatform","useAdaptivity","Tappable","AVATAR_DEFAULT_SIZE","AVATAR_DEFAULT_SHADOW","Avatar","alt","crossOrigin","decoding","height","loading","referrerPolicy","sizes","src","srcSet","useMap","width","getRef","size","shadow","mode","className","children","getRootRef","style","ariaLabel","badge","overlayIcon","overlayMode","passedOverlayAction","overlayAction","onClick","restProps","platform","hasMouse","useState","failedImage","setFailedImage","onImageError","onImageLoad","borderRadius","hasSrc","createScopedElement","vkuiClass","ref","role","undefined","onError","onLoad","Component","hoverMode","focusVisibleMode","hasActive"],"sources":["../../../src/components/Avatar/Avatar.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Icon12Circle, Icon12OnlineMobile } from \"@vkontakte/icons\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { classNames } from \"../../lib/classNames\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport Tappable from \"../Tappable/Tappable\";\nimport { HasRef, HasRootRef } from \"../../types\";\nimport \"./Avatar.css\";\n\nexport interface AvatarProps\n  extends React.ImgHTMLAttributes<HTMLElement>,\n    HasRootRef<HTMLDivElement>,\n    HasRef<HTMLImageElement> {\n  /**\n   * Рекомендуемый сет значений: 96 | 88 | 80 | 72 | 64 | 56 | 48 | 44 | 40 | 36 | 32 | 28 | 24\n   */\n  size?: number;\n  mode?: \"default\" | \"image\" | \"app\";\n  shadow?: boolean;\n  badge?: \"online\" | \"online-mobile\" | JSX.Element;\n  overlayIcon?: JSX.Element;\n  overlayMode?: \"dark\" | \"light\";\n  /**\n   * Поведение показа overlay: \"hover\" - при наведении, \"always\" - всегда\n   */\n  overlayAction?: \"hover\" | \"always\";\n}\n\nexport const AVATAR_DEFAULT_SIZE = 48;\nexport const AVATAR_DEFAULT_SHADOW = true;\n\nconst Avatar: React.FC<AvatarProps> = ({\n  alt,\n  crossOrigin,\n  decoding,\n  height,\n  loading,\n  referrerPolicy,\n  sizes,\n  src,\n  srcSet,\n  useMap,\n  width,\n  getRef,\n  size = AVATAR_DEFAULT_SIZE,\n  shadow = AVATAR_DEFAULT_SHADOW,\n  mode = \"default\",\n  className,\n  children,\n  getRootRef,\n  style,\n  \"aria-label\": ariaLabel,\n  badge,\n  overlayIcon,\n  overlayMode = \"light\",\n  overlayAction: passedOverlayAction,\n  onClick,\n  ...restProps\n}: AvatarProps) => {\n  const platform = usePlatform();\n  const { hasMouse } = useAdaptivity();\n  const [failedImage, setFailedImage] = React.useState(false);\n\n  const overlayAction = passedOverlayAction ?? (hasMouse ? \"hover\" : \"always\");\n\n  const onImageError = () => {\n    setFailedImage(true);\n  };\n\n  const onImageLoad = () => {\n    setFailedImage(false);\n  };\n\n  let borderRadius: string | number = \"50%\";\n\n  switch (mode) {\n    case \"image\":\n      size < 64 && (borderRadius = 4);\n      size >= 64 && size < 96 && (borderRadius = 6);\n      size >= 96 && (borderRadius = 8);\n      break;\n    case \"app\":\n      size <= 40 && (borderRadius = 8);\n      size > 40 && size < 56 && (borderRadius = 10);\n      size >= 56 && size < 64 && (borderRadius = 12);\n      size >= 64 && size < 84 && (borderRadius = 16);\n      size >= 84 && (borderRadius = 18);\n      break;\n    default:\n      break;\n  }\n\n  const hasSrc = src || srcSet;\n\n  return (\n    <div\n      {...restProps}\n      vkuiClass={classNames(\n        getClassName(\"Avatar\", platform),\n        `Avatar--type-${mode}`,\n        `Avatar--sz-${size}`,\n        {\n          \"Avatar--shadow\": shadow,\n          \"Avatar--failed\": failedImage,\n        }\n      )}\n      className={className}\n      ref={getRootRef}\n      role={hasSrc ? \"img\" : \"presentation\"}\n      aria-label={alt || ariaLabel}\n      onClick={!overlayIcon ? onClick : undefined}\n      style={{ ...style, width: size, height: size, borderRadius }}\n    >\n      {hasSrc && (\n        <img\n          crossOrigin={crossOrigin}\n          decoding={decoding}\n          height={height}\n          loading={loading}\n          referrerPolicy={referrerPolicy}\n          sizes={sizes}\n          src={src}\n          srcSet={srcSet}\n          useMap={useMap}\n          width={width}\n          ref={getRef}\n          onError={onImageError}\n          onLoad={onImageLoad}\n          vkuiClass=\"Avatar__img\"\n          alt=\"\"\n        />\n      )}\n      {children && <div vkuiClass=\"Avatar__children\">{children}</div>}\n      {overlayIcon && (\n        <Tappable\n          Component=\"button\"\n          vkuiClass={classNames(\"Avatar__overlay\", {\n            \"Avatar__overlay--visible\": overlayAction === \"always\",\n            \"Avatar__overlay--light\": overlayMode === \"light\",\n            \"Avatar__overlay--dark\": overlayMode === \"dark\",\n          })}\n          hoverMode=\"Avatar__overlay--visible\"\n          focusVisibleMode=\"Avatar__overlay--focus-visible\"\n          hasActive={false}\n          onClick={onClick}\n        >\n          {overlayIcon}\n        </Tappable>\n      )}\n      {badge && (\n        <div\n          vkuiClass={classNames(\"Avatar__badge\", {\n            \"Avatar__badge--large\": size >= 96,\n            \"Avatar__badge--shadow\":\n              badge !== \"online\" && badge !== \"online-mobile\",\n          })}\n        >\n          {badge === \"online\" ? (\n            <div vkuiClass=\"Avatar__badge-online\">\n              <Icon12Circle\n                width={size >= 72 ? 15 : 12}\n                height={size >= 72 ? 15 : 12}\n              />\n            </div>\n          ) : badge === \"online-mobile\" ? (\n            <div vkuiClass=\"Avatar__badge-online-mobile\">\n              <Icon12OnlineMobile\n                width={size >= 72 ? 9 : 8}\n                height={size >= 72 ? 15 : 12}\n              />\n            </div>\n          ) : (\n            badge\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\n// eslint-disable-next-line import/no-default-export\nexport default Avatar;\n"]},"metadata":{},"sourceType":"module"}