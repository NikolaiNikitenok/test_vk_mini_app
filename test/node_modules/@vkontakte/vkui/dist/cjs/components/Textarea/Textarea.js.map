{"version":3,"sources":["../../../../src/components/Textarea/Textarea.tsx"],"names":["Textarea","React","memo","defaultValue","grow","style","onResize","className","getRootRef","getRef","sizeY","rows","restProps","value","onChange","currentScrollHeight","useRef","elementRef","platform","useEffect","el","current","offsetParent","height","scrollHeight","disabled"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;;AAaA,IAAMA,QAAiC,gBAAGC,KAAK,CAACC,IAAN,CACxC,gBAWqB;AAAA,+BAVnBC,YAUmB;AAAA,MAVnBA,YAUmB,kCAVJ,EAUI;AAAA,uBATnBC,IASmB;AAAA,MATnBA,IASmB,0BATZ,IASY;AAAA,MARnBC,KAQmB,QARnBA,KAQmB;AAAA,MAPnBC,QAOmB,QAPnBA,QAOmB;AAAA,MANnBC,SAMmB,QANnBA,SAMmB;AAAA,MALnBC,UAKmB,QALnBA,UAKmB;AAAA,MAJnBC,MAImB,QAJnBA,MAImB;AAAA,MAHnBC,KAGmB,QAHnBA,KAGmB;AAAA,uBAFnBC,IAEmB;AAAA,MAFnBA,IAEmB,0BAFZ,CAEY;AAAA,MADhBC,SACgB;;AACnB,2BAA0B,2CAAkBA,SAAlB,EAA6B;AAAET,IAAAA,YAAY,EAAZA;AAAF,GAA7B,CAA1B;AAAA;AAAA,MAAOU,KAAP;AAAA,MAAcC,QAAd;;AACA,MAAMC,mBAAmB,GAAGd,KAAK,CAACe,MAAN,EAA5B;AACA,MAAMC,UAAU,GAAG,gCAAaR,MAAb,CAAnB;AACA,MAAMS,QAAQ,GAAG,+BAAjB,CAJmB,CAMnB;;AACAjB,EAAAA,KAAK,CAACkB,SAAN,CAAgB,YAAM;AACpB,QAAMC,EAAE,GAAGH,UAAU,CAACI,OAAtB;;AAEA,QAAIjB,IAAI,IAAIgB,EAAJ,aAAIA,EAAJ,eAAIA,EAAE,CAAEE,YAAhB,EAA8B;AAC5BF,MAAAA,EAAE,CAACf,KAAH,CAASkB,MAAT,GAAkB,EAAlB;AACAH,MAAAA,EAAE,CAACf,KAAH,CAASkB,MAAT,aAAqBH,EAAE,CAACI,YAAxB;;AAEA,UAAIJ,EAAE,CAACI,YAAH,KAAoBT,mBAAmB,CAACM,OAAxC,IAAmDf,QAAvD,EAAiE;AAC/DA,QAAAA,QAAQ,CAACc,EAAD,CAAR;AACAL,QAAAA,mBAAmB,CAACM,OAApB,GAA8BD,EAAE,CAACI,YAAjC;AACD;AACF;AACF,GAZD,EAYG,CAACpB,IAAD,EAAOS,KAAP,EAAcH,KAAd,EAAqBO,UAArB,EAAiCX,QAAjC,CAZH;AAcA,SACE,qCAAC,oBAAD;AACE,IAAA,SAAS,EAAE,4BACT,gCAAa,UAAb,EAAyBY,QAAzB,CADS,4BAEUR,KAFV,EADb;AAKE,IAAA,SAAS,EAAEH,SALb;AAME,IAAA,KAAK,EAAEF,KANT;AAOE,IAAA,UAAU,EAAEG,UAPd;AAQE,IAAA,QAAQ,EAAEI,SAAS,CAACa;AARtB,KAUE,4EACMb,SADN;AAEE,IAAA,IAAI,EAAED,IAFR;AAGE,IAAA,SAAS,EAAC,cAHZ;AAIE,IAAA,KAAK,EAAEE,KAJT;AAKE,IAAA,QAAQ,EAAEC,QALZ;AAME,IAAA,GAAG,EAAEG;AANP,KAVF,CADF;AAqBD,CAtDuC,CAA1C,C,CAyDA;;eACe,oCAAejB,QAAf,EAAyB;AAAEU,EAAAA,KAAK,EAAE;AAAT,CAAzB,C","sourcesContent":["import * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport { FormField } from \"../FormField/FormField\";\nimport { HasRef, HasRootRef } from \"../../types\";\nimport { withAdaptivity, AdaptivityProps } from \"../../hoc/withAdaptivity\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { useEnsuredControl } from \"../../hooks/useEnsuredControl\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport \"./Textarea.css\";\n\nexport interface TextareaProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement>,\n    HasRef<HTMLTextAreaElement>,\n    HasRootRef<HTMLElement>,\n    AdaptivityProps {\n  grow?: boolean;\n  onResize?(el: HTMLTextAreaElement): void;\n  defaultValue?: string;\n}\n\nconst Textarea: React.FC<TextareaProps> = React.memo(\n  ({\n    defaultValue = \"\",\n    grow = true,\n    style,\n    onResize,\n    className,\n    getRootRef,\n    getRef,\n    sizeY,\n    rows = 2,\n    ...restProps\n  }: TextareaProps) => {\n    const [value, onChange] = useEnsuredControl(restProps, { defaultValue });\n    const currentScrollHeight = React.useRef<number>();\n    const elementRef = useExternRef(getRef);\n    const platform = usePlatform();\n\n    // autosize input\n    React.useEffect(() => {\n      const el = elementRef.current;\n\n      if (grow && el?.offsetParent) {\n        el.style.height = \"\";\n        el.style.height = `${el.scrollHeight}px`;\n\n        if (el.scrollHeight !== currentScrollHeight.current && onResize) {\n          onResize(el);\n          currentScrollHeight.current = el.scrollHeight;\n        }\n      }\n    }, [grow, value, sizeY, elementRef, onResize]);\n\n    return (\n      <FormField\n        vkuiClass={classNames(\n          getClassName(\"Textarea\", platform),\n          `Textarea--sizeY-${sizeY}`\n        )}\n        className={className}\n        style={style}\n        getRootRef={getRootRef}\n        disabled={restProps.disabled}\n      >\n        <textarea\n          {...restProps}\n          rows={rows}\n          vkuiClass=\"Textarea__el\"\n          value={value}\n          onChange={onChange}\n          ref={elementRef}\n        />\n      </FormField>\n    );\n  }\n);\n\n// eslint-disable-next-line import/no-default-export\nexport default withAdaptivity(Textarea, { sizeY: true });\n"],"file":"Textarea.js"}