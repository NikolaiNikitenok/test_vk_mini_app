{"version":3,"sources":["../../../../src/components/Gallery/Gallery.tsx"],"names":["React","getClassName","Touch","classNames","withPlatform","withDOM","setRef","withAdaptivity","HorizontalScrollArrow","clamp","useTimeout","BaseGallery","props","setState","animation","e","isDraggable","isFullyVisible","originalEvent","preventDefault","isSlideX","onDragStart","state","deltaX","shiftX","dragging","targetIndex","isSlide","getTarget","slideIndex","onDragEnd","onChange","onEnd","initializeSlides","canSlideLeft","canSlideRight","id","slide","slidesStore","viewport","getRef","container","getRootRef","containerWidth","slides","duration","slideWidth","align","options","Children","map","children","_item","i","elem","coordX","offsetLeft","width","offsetWidth","layerWidth","reduce","val","min","calcMin","max","calcMax","undefined","calculateIndent","isValidShift","validateIndent","window","requestAnimationFrame","viewportWidth","isCenterWithCustomWidth","length","targetSlide","indent","Number","value","expectDeltaX","shift","direction","item","index","previousValue","Math","abs","currentValue","addEventListener","onResize","prevProps","widthChanged","isPropUpdate","slideCountChanged","count","isCustomWidth","removeEventListener","bullets","platform","hasMouse","showArrows","document","restProps","calculateDragIndent","layerStyle","WebkitTransform","transform","WebkitTransition","transition","onStart","onMoveX","getViewportRef","getSlideRef","slideLeft","slideRight","Component","BaseGalleryAdaptive","Gallery","initialSlideIndex","timeout","useState","localSlideIndex","setSlideIndex","isControlled","Boolean","toArray","filter","childCount","handleChange","useCallback","current","autoplay","useEffect","set","clear","safeSlideIndex"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { Touch, TouchEventHandler, TouchEvent } from \"../Touch/Touch\";\nimport { classNames } from \"../../lib/classNames\";\nimport { withPlatform } from \"../../hoc/withPlatform\";\nimport { HasAlign, HasPlatform, HasRef, HasRootRef } from \"../../types\";\nimport { withDOM, DOMProps } from \"../../lib/dom\";\nimport { setRef } from \"../../lib/utils\";\nimport { withAdaptivity, AdaptivityProps } from \"../../hoc/withAdaptivity\";\nimport HorizontalScrollArrow from \"../HorizontalScroll/HorizontalScrollArrow\";\nimport { clamp } from \"../../helpers/math\";\nimport { useTimeout } from \"../../hooks/useTimeout\";\nimport \"./Gallery.css\";\n\nexport interface BaseGalleryProps\n  extends Omit<\n      React.HTMLAttributes<HTMLDivElement>,\n      \"onChange\" | \"onDragStart\" | \"onDragEnd\"\n    >,\n    HasPlatform,\n    HasAlign,\n    HasRootRef<HTMLDivElement>,\n    HasRef<HTMLElement> {\n  slideWidth?: string | number;\n  slideIndex?: number;\n  onDragStart?: TouchEventHandler;\n  onDragEnd?: TouchEventHandler;\n  onChange?(current: number): void;\n  onEnd?({ targetIndex }: { targetIndex: number }): void;\n  bullets?: \"dark\" | \"light\" | false;\n  isDraggable?: boolean;\n  showArrows?: boolean;\n}\n\nexport interface GalleryProps extends BaseGalleryProps {\n  initialSlideIndex?: number;\n  timeout?: number;\n}\n\nexport interface GalleryState {\n  containerWidth: number;\n  layerWidth?: number;\n  min?: number;\n  max?: number;\n  deltaX: number;\n  shiftX: number;\n  slides: GallerySlidesState[];\n  animation: boolean;\n  duration: number;\n  dragging?: boolean;\n}\n\nexport interface GallerySlidesState {\n  coordX: number;\n  width: number;\n}\n\ntype GetSlideRef = (index: number) => React.RefCallback<HTMLElement>;\n\nclass BaseGallery extends React.Component<\n  BaseGalleryProps & DOMProps & AdaptivityProps,\n  GalleryState\n> {\n  constructor(props: GalleryProps) {\n    super(props);\n\n    this.state = {\n      containerWidth: 0,\n      deltaX: 0,\n      shiftX: 0,\n      slides: [],\n      animation: true,\n      duration: 0.24,\n    };\n\n    this.slidesStore = {};\n  }\n\n  container: HTMLDivElement | null = null;\n  slidesStore: {\n    [index: string]: HTMLElement | null;\n  };\n  viewport: HTMLElement | null = null;\n\n  static defaultProps: Partial<BaseGalleryProps> = {\n    slideWidth: \"100%\",\n    children: \"\",\n    align: \"left\",\n    bullets: false,\n    isDraggable: true,\n  };\n\n  get isCenterWithCustomWidth() {\n    return this.props.slideWidth === \"custom\" && this.props.align === \"center\";\n  }\n\n  initializeSlides(options: { animation?: boolean } = {}) {\n    const slides =\n      React.Children.map(\n        this.props.children,\n        (_item: React.ReactNode, i: number): GallerySlidesState => {\n          const elem = this.slidesStore[`slide-${i}`];\n          return {\n            coordX: elem?.offsetLeft ?? 0,\n            width: elem?.offsetWidth ?? 0,\n          };\n        }\n      ) ?? [];\n\n    const containerWidth = this.container?.offsetWidth ?? 0;\n    const layerWidth = slides.reduce(\n      (val: number, slide: GallerySlidesState) => slide.width + val,\n      0\n    );\n\n    const min = this.calcMin({ containerWidth, layerWidth, slides });\n    const max = this.calcMax({ slides });\n\n    this.setState({ min, max, layerWidth, containerWidth, slides }, () => {\n      if (this.props.slideIndex !== undefined) {\n        const shiftX = this.calculateIndent(this.props.slideIndex);\n        if (this.state.shiftX === shiftX) {\n          return;\n        }\n        const isValidShift =\n          this.state.shiftX === this.validateIndent(this.state.shiftX);\n        const { animation = isValidShift } = options;\n        this.setState({ shiftX, animation }, () => {\n          if (!this.state.animation) {\n            this.props.window?.requestAnimationFrame(() =>\n              this.setState({ animation: true })\n            );\n          }\n        });\n      }\n    });\n  }\n\n  calcMin({\n    containerWidth,\n    layerWidth = 0,\n    slides,\n  }: Pick<GalleryState, \"containerWidth\" | \"layerWidth\" | \"slides\">) {\n    const viewportWidth = this.viewport?.offsetWidth ?? 0;\n    switch (this.props.align) {\n      case \"left\":\n        return containerWidth - layerWidth;\n      case \"right\":\n        return viewportWidth - layerWidth;\n      case \"center\":\n        if (this.isCenterWithCustomWidth && slides.length) {\n          const { coordX, width } = slides[slides.length - 1];\n          return viewportWidth / 2 - coordX - width / 2;\n        } else {\n          return (\n            viewportWidth - (containerWidth - viewportWidth) / 2 - layerWidth\n          );\n        }\n    }\n    return undefined;\n  }\n\n  calcMax({ slides }: Pick<GalleryState, \"slides\">) {\n    const viewportWidth = this.viewport?.offsetWidth ?? 0;\n    if (this.isCenterWithCustomWidth && slides.length) {\n      const { width, coordX } = slides[0];\n      return viewportWidth / 2 - coordX - width / 2;\n    } else {\n      return 0;\n    }\n  }\n\n  /*\n   * Считает отступ слоя галереи\n   */\n  calculateIndent(targetIndex: number) {\n    const { slides } = this.state;\n\n    if (this.isFullyVisible) {\n      return 0;\n    }\n\n    const targetSlide = slides.length ? slides[targetIndex] : null;\n\n    if (targetSlide) {\n      const { coordX, width } = targetSlide;\n\n      if (this.isCenterWithCustomWidth) {\n        const viewportWidth = this.viewport?.offsetWidth ?? 0;\n        return viewportWidth / 2 - coordX - width / 2;\n      }\n\n      return this.validateIndent(-1 * coordX);\n    } else {\n      return 0;\n    }\n  }\n\n  /*\n   * Считает отступ слоя галереи во время драга\n   */\n  calculateDragIndent() {\n    const { shiftX, deltaX, min = 0, max = 0 } = this.state;\n    const indent = shiftX + deltaX;\n\n    if (indent > max) {\n      return max + Number((indent - max) / 3);\n    } else if (indent < min) {\n      return min + Number((indent - min) / 3);\n    }\n\n    return indent;\n  }\n\n  validateIndent(value: number) {\n    const { min = 0, max = 0 } = this.state;\n\n    if (value < min) {\n      return min;\n    } else if (value > max) {\n      return max;\n    }\n\n    return value;\n  }\n\n  get isFullyVisible() {\n    return (this.state.layerWidth ?? 0) <= this.state.containerWidth;\n  }\n\n  /*\n   * Получает индекс слайда, к которому будет осуществлен переход\n   */\n  getTarget(e: TouchEvent) {\n    const { slides, deltaX, shiftX, max = 0 } = this.state;\n    const { slideIndex = 0 } = this.props;\n    const expectDeltaX = (deltaX / e.duration) * 240 * 0.6;\n    const shift = shiftX + deltaX + expectDeltaX - max;\n    const direction = deltaX < 0 ? 1 : -1;\n\n    // Находим ближайшую границу слайда к текущему отступу\n    let targetIndex = slides.reduce(\n      (val: number, item: GallerySlidesState, index: number) => {\n        const previousValue = Math.abs(slides[val].coordX + shift);\n        const currentValue = Math.abs(item.coordX + shift);\n\n        return previousValue < currentValue ? val : index;\n      },\n      slideIndex\n    );\n\n    if (targetIndex === slideIndex) {\n      let targetSlide = slideIndex + direction;\n\n      if (targetSlide >= 0 && targetSlide < slides.length) {\n        if (Math.abs(deltaX) > slides[targetSlide].width * 0.05) {\n          targetIndex = targetSlide;\n        }\n      }\n    }\n\n    return targetIndex;\n  }\n\n  onStart: TouchEventHandler = () => {\n    this.setState({\n      animation: false,\n    });\n  };\n\n  onMoveX: TouchEventHandler = (e: TouchEvent) => {\n    if (this.props.isDraggable && !this.isFullyVisible) {\n      e.originalEvent.preventDefault();\n\n      if (e.isSlideX) {\n        this.props.onDragStart && this.props.onDragStart(e);\n\n        if (\n          this.state.deltaX !== e.shiftX ||\n          this.state.dragging !== e.isSlideX\n        ) {\n          this.setState({\n            deltaX: e.shiftX,\n            dragging: e.isSlideX,\n          });\n        }\n      }\n    }\n  };\n\n  onEnd: TouchEventHandler = (e: TouchEvent) => {\n    const targetIndex = e.isSlide\n      ? this.getTarget(e)\n      : this.props.slideIndex ?? 0;\n    this.props.onDragEnd && this.props.onDragEnd(e);\n    this.setState({ deltaX: 0, animation: true }, () =>\n      this.props.onChange?.(targetIndex)\n    );\n\n    if (this.props.onEnd) {\n      this.props.onEnd({ targetIndex });\n    }\n  };\n\n  onResize: VoidFunction = () => this.initializeSlides({ animation: false });\n\n  get canSlideLeft() {\n    // shiftX is negative number <= 0, we can swipe back only if it is < 0\n    return !this.isFullyVisible && this.state.shiftX < 0;\n  }\n\n  get canSlideRight() {\n    const { containerWidth, layerWidth = 0, shiftX, slides } = this.state;\n    const { align, slideIndex = 0 } = this.props;\n    return (\n      !this.isFullyVisible &&\n      // we can't move right when gallery layer fully scrolled right, if gallery aligned by left side\n      ((align === \"left\" && containerWidth - shiftX < layerWidth) ||\n        // otherwise we need to check current slide index (align = right or align = center)\n        (align !== \"left\" && slideIndex < slides.length - 1))\n    );\n  }\n\n  slideLeft = () => {\n    const { slideIndex = 0, onChange } = this.props;\n    if (this.canSlideLeft) {\n      this.setState({ deltaX: 0, animation: true }, () =>\n        onChange?.(slideIndex - 1)\n      );\n    }\n  };\n\n  slideRight = () => {\n    const { slideIndex = 0, onChange } = this.props;\n    if (this.canSlideRight) {\n      this.setState({ deltaX: 0, animation: true }, () =>\n        onChange?.(slideIndex + 1)\n      );\n    }\n  };\n\n  getSlideRef: GetSlideRef = (id: number) => (slide) => {\n    this.slidesStore[`slide-${id}`] = slide;\n  };\n\n  getViewportRef: React.RefCallback<HTMLElement> = (viewport) => {\n    this.viewport = viewport;\n    if (this.props.getRef) {\n      setRef(viewport, this.props.getRef);\n    }\n  };\n\n  getRootRef: React.RefCallback<HTMLDivElement> = (container) => {\n    this.container = container;\n    if (this.props.getRootRef) {\n      setRef(container, this.props.getRootRef);\n    }\n  };\n\n  componentDidMount() {\n    this.initializeSlides({ animation: false });\n    this.props.window!.addEventListener(\"resize\", this.onResize);\n  }\n\n  componentDidUpdate(prevProps: GalleryProps) {\n    const widthChanged = this.props.slideWidth !== prevProps.slideWidth;\n    const isPropUpdate = this.props !== prevProps;\n    const slideCountChanged =\n      React.Children.count(this.props.children) !==\n      React.Children.count(prevProps.children);\n    const isCustomWidth = this.props.slideWidth === \"custom\";\n\n    // в любом из этих случаев позиция могла поменяться\n    if (widthChanged || slideCountChanged || (isCustomWidth && isPropUpdate)) {\n      this.initializeSlides();\n    } else if (this.props.slideIndex !== prevProps.slideIndex) {\n      this.setState({\n        animation: true,\n        deltaX: 0,\n        shiftX: this.calculateIndent(this.props.slideIndex ?? 0),\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.window!.removeEventListener(\"resize\", this.onResize);\n  }\n\n  render() {\n    const { animation, duration, dragging } = this.state;\n    const {\n      children,\n      slideWidth,\n      slideIndex = 0,\n      isDraggable,\n      onDragStart,\n      onDragEnd,\n      onChange,\n      onEnd,\n      align,\n      bullets,\n      platform,\n      hasMouse,\n      showArrows,\n      window,\n      document,\n      getRef,\n      getRootRef,\n      ...restProps\n    } = this.props;\n\n    const indent = dragging\n      ? this.calculateDragIndent()\n      : this.calculateIndent(slideIndex);\n\n    const layerStyle = {\n      WebkitTransform: `translateX(${indent}px)`,\n      transform: `translateX(${indent}px)`,\n      WebkitTransition: animation\n        ? `-webkit-transform ${duration}s cubic-bezier(.1, 0, .25, 1)`\n        : \"none\",\n      transition: animation\n        ? `transform ${duration}s cubic-bezier(.1, 0, .25, 1)`\n        : \"none\",\n    };\n\n    return (\n      <div\n        {...restProps}\n        vkuiClass={classNames(\n          getClassName(\"Gallery\", platform),\n          `Gallery--${align}`,\n          {\n            \"Gallery--dragging\": dragging,\n            \"Gallery--custom-width\": slideWidth === \"custom\",\n          }\n        )}\n        ref={this.getRootRef}\n      >\n        <Touch\n          vkuiClass=\"Gallery__viewport\"\n          onStartX={this.onStart}\n          onMoveX={this.onMoveX}\n          onEnd={this.onEnd}\n          noSlideClick\n          style={{ width: slideWidth === \"custom\" ? \"100%\" : slideWidth }}\n          getRootRef={this.getViewportRef}\n        >\n          <div vkuiClass=\"Gallery__layer\" style={layerStyle}>\n            {React.Children.map(\n              children,\n              (item: React.ReactNode, i: number) => (\n                <div\n                  vkuiClass=\"Gallery__slide\"\n                  key={`slide-${i}`}\n                  ref={this.getSlideRef(i)}\n                >\n                  {item}\n                </div>\n              )\n            )}\n          </div>\n        </Touch>\n\n        {bullets && (\n          <div\n            aria-hidden=\"true\"\n            vkuiClass={classNames(\n              \"Gallery__bullets\",\n              `Gallery__bullets--${bullets}`\n            )}\n          >\n            {React.Children.map(\n              children,\n              (_item: React.ReactNode, index: number) => (\n                <div\n                  vkuiClass={classNames(\"Gallery__bullet\", {\n                    \"Gallery__bullet--active\": index === slideIndex,\n                  })}\n                  key={index}\n                />\n              )\n            )}\n          </div>\n        )}\n\n        {showArrows && hasMouse && this.canSlideLeft && (\n          <HorizontalScrollArrow direction=\"left\" onClick={this.slideLeft} />\n        )}\n        {showArrows && hasMouse && this.canSlideRight && (\n          <HorizontalScrollArrow direction=\"right\" onClick={this.slideRight} />\n        )}\n      </div>\n    );\n  }\n}\n\nconst BaseGalleryAdaptive = withAdaptivity(withDOM(BaseGallery), {\n  hasMouse: true,\n});\n\nconst Gallery: React.FC<GalleryProps> = ({\n  initialSlideIndex = 0,\n  children,\n  timeout = 0,\n  onChange,\n  ...props\n}: GalleryProps) => {\n  const [localSlideIndex, setSlideIndex] = React.useState(initialSlideIndex);\n  const isControlled = typeof props.slideIndex === \"number\";\n  const slideIndex = isControlled ? props.slideIndex ?? 0 : localSlideIndex;\n  const isDraggable = !isControlled || Boolean(onChange);\n  const slides = React.Children.toArray(children).filter((item) =>\n    Boolean(item)\n  );\n  const childCount = slides.length;\n\n  const handleChange: GalleryProps[\"onChange\"] = React.useCallback(\n    (current) => {\n      if (current === slideIndex) {\n        return;\n      }\n      !isControlled && setSlideIndex(current);\n      onChange && onChange(current);\n    },\n    [isControlled, onChange, slideIndex]\n  );\n\n  const autoplay = useTimeout(\n    () => handleChange((slideIndex + 1) % childCount),\n    timeout\n  );\n  React.useEffect(\n    () => (timeout ? autoplay.set() : autoplay.clear()),\n    [timeout, slideIndex, autoplay]\n  );\n\n  // prevent invalid slideIndex\n  // any slide index is invalid with no slides, just keep it as is\n  const safeSlideIndex =\n    childCount > 0 ? clamp(slideIndex, 0, childCount - 1) : slideIndex;\n  // notify parent in controlled mode\n  React.useEffect(() => {\n    if (onChange && safeSlideIndex !== slideIndex) {\n      onChange(safeSlideIndex);\n    }\n  }, [onChange, safeSlideIndex, slideIndex]);\n\n  return (\n    <BaseGalleryAdaptive\n      isDraggable={isDraggable}\n      {...props}\n      slideIndex={safeSlideIndex}\n      onChange={handleChange}\n    >\n      {slides}\n    </BaseGalleryAdaptive>\n  );\n};\n\n// eslint-disable-next-line import/no-default-export\nexport default withPlatform(Gallery);\n"],"file":"Gallery.js"}