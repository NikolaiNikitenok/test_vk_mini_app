{"version":3,"sources":["../../../src/lib/animate.ts"],"names":["animate","duration","timing","draw","canUseDOM","start","performance","now","requestAnimationFrame","time","timeFraction","progress"],"mappings":";;;;;;;AAAA;;AAmBA;AACe,SAASA,OAAT,OAIqB;AAAA,MAHlCC,QAGkC,QAHlCA,QAGkC;AAAA,MAFlCC,MAEkC,QAFlCA,MAEkC;AAAA,MADlCC,IACkC,QADlCA,IACkC;;AAClC,MAAI,CAACC,eAAL,EAAgB;AACd;AACD;;AAED,MAAMC,KAAK,GAAGC,WAAW,CAACC,GAAZ,EAAd;AAEAC,EAAAA,qBAAqB,CAAC,SAASR,OAAT,CAAiBS,IAAjB,EAAqC;AACzD,QAAIC,YAAY,GAAG,CAACD,IAAI,GAAGJ,KAAR,IAAiBJ,QAApC;;AAEA,QAAIS,YAAY,GAAG,CAAnB,EAAsB;AACpBA,MAAAA,YAAY,GAAG,CAAf;AACD;;AAED,QAAMC,QAAQ,GAAGT,MAAM,CAACQ,YAAD,CAAvB;AAEAP,IAAAA,IAAI,CAACQ,QAAD,CAAJ;;AAEA,QAAID,YAAY,GAAG,CAAnB,EAAsB;AACpBF,MAAAA,qBAAqB,CAACR,OAAD,CAArB;AACD;AACF,GAdoB,CAArB;AAeD","sourcesContent":["import { canUseDOM } from \"@vkontakte/vkjs\";\n\n/**\n * Функция для js анимации\n * @param {number} duration\n * @param {function} timing тайминг функция анимации\n * @param {function} draw коллбэк, в который прокидывается прогресс [0, 1]\n * @returns {void}\n */\nexport type TimingInterface = (timeFraction: number) => number;\n\nexport type DrawInterface = (progress: number) => void;\n\nexport interface AnimateArgumentsInterface {\n  duration: number;\n  timing: TimingInterface;\n  draw: DrawInterface;\n}\n\n// eslint-disable-next-line import/no-default-export\nexport default function animate({\n  duration,\n  timing,\n  draw,\n}: AnimateArgumentsInterface): void {\n  if (!canUseDOM) {\n    return;\n  }\n\n  const start = performance.now();\n\n  requestAnimationFrame(function animate(time: number): void {\n    let timeFraction = (time - start) / duration;\n\n    if (timeFraction > 1) {\n      timeFraction = 1;\n    }\n\n    const progress = timing(timeFraction);\n\n    draw(progress);\n\n    if (timeFraction < 1) {\n      requestAnimationFrame(animate);\n    }\n  });\n}\n"],"file":"animate.js"}