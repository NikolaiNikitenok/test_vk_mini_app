{"version":3,"sources":["../../../../src/components/Avatar/Avatar.tsx"],"names":["AVATAR_DEFAULT_SIZE","AVATAR_DEFAULT_SHADOW","Avatar","alt","crossOrigin","decoding","height","loading","referrerPolicy","sizes","src","srcSet","useMap","width","getRef","size","shadow","mode","className","children","getRootRef","style","ariaLabel","badge","overlayIcon","overlayMode","passedOverlayAction","overlayAction","onClick","restProps","platform","hasMouse","React","useState","failedImage","setFailedImage","onImageError","onImageLoad","borderRadius","hasSrc","undefined"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { Icon12Circle, Icon12OnlineMobile } from \"@vkontakte/icons\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { classNames } from \"../../lib/classNames\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport Tappable from \"../Tappable/Tappable\";\nimport { HasRef, HasRootRef } from \"../../types\";\nimport \"./Avatar.css\";\n\nexport interface AvatarProps\n  extends React.ImgHTMLAttributes<HTMLElement>,\n    HasRootRef<HTMLDivElement>,\n    HasRef<HTMLImageElement> {\n  /**\n   * Рекомендуемый сет значений: 96 | 88 | 80 | 72 | 64 | 56 | 48 | 44 | 40 | 36 | 32 | 28 | 24\n   */\n  size?: number;\n  mode?: \"default\" | \"image\" | \"app\";\n  shadow?: boolean;\n  badge?: \"online\" | \"online-mobile\" | JSX.Element;\n  overlayIcon?: JSX.Element;\n  overlayMode?: \"dark\" | \"light\";\n  /**\n   * Поведение показа overlay: \"hover\" - при наведении, \"always\" - всегда\n   */\n  overlayAction?: \"hover\" | \"always\";\n}\n\nexport const AVATAR_DEFAULT_SIZE = 48;\nexport const AVATAR_DEFAULT_SHADOW = true;\n\nconst Avatar: React.FC<AvatarProps> = ({\n  alt,\n  crossOrigin,\n  decoding,\n  height,\n  loading,\n  referrerPolicy,\n  sizes,\n  src,\n  srcSet,\n  useMap,\n  width,\n  getRef,\n  size = AVATAR_DEFAULT_SIZE,\n  shadow = AVATAR_DEFAULT_SHADOW,\n  mode = \"default\",\n  className,\n  children,\n  getRootRef,\n  style,\n  \"aria-label\": ariaLabel,\n  badge,\n  overlayIcon,\n  overlayMode = \"light\",\n  overlayAction: passedOverlayAction,\n  onClick,\n  ...restProps\n}: AvatarProps) => {\n  const platform = usePlatform();\n  const { hasMouse } = useAdaptivity();\n  const [failedImage, setFailedImage] = React.useState(false);\n\n  const overlayAction = passedOverlayAction ?? (hasMouse ? \"hover\" : \"always\");\n\n  const onImageError = () => {\n    setFailedImage(true);\n  };\n\n  const onImageLoad = () => {\n    setFailedImage(false);\n  };\n\n  let borderRadius: string | number = \"50%\";\n\n  switch (mode) {\n    case \"image\":\n      size < 64 && (borderRadius = 4);\n      size >= 64 && size < 96 && (borderRadius = 6);\n      size >= 96 && (borderRadius = 8);\n      break;\n    case \"app\":\n      size <= 40 && (borderRadius = 8);\n      size > 40 && size < 56 && (borderRadius = 10);\n      size >= 56 && size < 64 && (borderRadius = 12);\n      size >= 64 && size < 84 && (borderRadius = 16);\n      size >= 84 && (borderRadius = 18);\n      break;\n    default:\n      break;\n  }\n\n  const hasSrc = src || srcSet;\n\n  return (\n    <div\n      {...restProps}\n      vkuiClass={classNames(\n        getClassName(\"Avatar\", platform),\n        `Avatar--type-${mode}`,\n        `Avatar--sz-${size}`,\n        {\n          \"Avatar--shadow\": shadow,\n          \"Avatar--failed\": failedImage,\n        }\n      )}\n      className={className}\n      ref={getRootRef}\n      role={hasSrc ? \"img\" : \"presentation\"}\n      aria-label={alt || ariaLabel}\n      onClick={!overlayIcon ? onClick : undefined}\n      style={{ ...style, width: size, height: size, borderRadius }}\n    >\n      {hasSrc && (\n        <img\n          crossOrigin={crossOrigin}\n          decoding={decoding}\n          height={height}\n          loading={loading}\n          referrerPolicy={referrerPolicy}\n          sizes={sizes}\n          src={src}\n          srcSet={srcSet}\n          useMap={useMap}\n          width={width}\n          ref={getRef}\n          onError={onImageError}\n          onLoad={onImageLoad}\n          vkuiClass=\"Avatar__img\"\n          alt=\"\"\n        />\n      )}\n      {children && <div vkuiClass=\"Avatar__children\">{children}</div>}\n      {overlayIcon && (\n        <Tappable\n          Component=\"button\"\n          vkuiClass={classNames(\"Avatar__overlay\", {\n            \"Avatar__overlay--visible\": overlayAction === \"always\",\n            \"Avatar__overlay--light\": overlayMode === \"light\",\n            \"Avatar__overlay--dark\": overlayMode === \"dark\",\n          })}\n          hoverMode=\"Avatar__overlay--visible\"\n          focusVisibleMode=\"Avatar__overlay--focus-visible\"\n          hasActive={false}\n          onClick={onClick}\n        >\n          {overlayIcon}\n        </Tappable>\n      )}\n      {badge && (\n        <div\n          vkuiClass={classNames(\"Avatar__badge\", {\n            \"Avatar__badge--large\": size >= 96,\n            \"Avatar__badge--shadow\":\n              badge !== \"online\" && badge !== \"online-mobile\",\n          })}\n        >\n          {badge === \"online\" ? (\n            <div vkuiClass=\"Avatar__badge-online\">\n              <Icon12Circle\n                width={size >= 72 ? 15 : 12}\n                height={size >= 72 ? 15 : 12}\n              />\n            </div>\n          ) : badge === \"online-mobile\" ? (\n            <div vkuiClass=\"Avatar__badge-online-mobile\">\n              <Icon12OnlineMobile\n                width={size >= 72 ? 9 : 8}\n                height={size >= 72 ? 15 : 12}\n              />\n            </div>\n          ) : (\n            badge\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\n// eslint-disable-next-line import/no-default-export\nexport default Avatar;\n"],"file":"Avatar.js"}